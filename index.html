<div id="additional-order-details" class="mt-6 space-y-4 hidden border-t border-gray-200 pt-6">
        <h4 class="text-md font-semibold text-gray-700 mb-1">Ek Sipariş ve Teslimat Bilgileri</h4>
        <p class="text-xs text-gray-500 mb-4">Lütfen siparişinizi tamamlamak için aşağıdaki ek bilgileri doldurun.</p>

        <div>
            <label for="order-product-name" class="block text-sm font-medium text-gray-700 mb-1">Ürün Adı / Model / Renk / Beden</label>
            <div class="relative">
                <i class="ri-pencil-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                <input type="text" id="order-product-name" name="orderProductName" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary text-sm" placeholder="Örn: Kırmızı Elbise, M Beden">
            </div>
        </div>

        <div>
            <label for="order-quantity" class="block text-sm font-medium text-gray-700 mb-1">Adet</label>
            <div class="relative">
                <i class="ri-numbers-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                <input type="number" id="order-quantity" name="orderQuantity" value="1" min="1" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary text-sm">
            </div>
            <p class="text-xs text-gray-500 mt-1">Not: Mevcut hesaplama tek bir kargo paketi ücretini yansıtır. Çoklu adetler için ek ücretler uygulanabilir.</p>
        </div>

        <div id="home-delivery-fields-order" class="space-y-4"> <div>
                <label for="order-delivery-address" class="block text-sm font-medium text-gray-700 mb-1">Tam Teslimat Adresi (Kıbrıs)</label>
                <div class="relative">
                    <i class="ri-map-pin-user-line ri-lg absolute left-3 top-3 text-gray-400"></i>
                    <textarea id="order-delivery-address" name="orderDeliveryAddress" rows="3" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary text-sm" placeholder="Mahalle, Cadde/Sokak, Kapı No, Daire No"></textarea>
                </div>
            </div>
        </div>

        <div class="mt-4">
            <label for="order-phone-number" class="block text-sm font-medium text-gray-700 mb-1">Telefon Numarası (Kıbrıs)</label>
            <div class="relative">
                <i class="ri-phone-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                <input type="tel" id="order-phone-number" name="orderPhoneNumber" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary text-sm" placeholder="+90 XXX XXX XX XX">
            </div>
        </div>
        
        <div>
            <label for="order-notes" class="block text-sm font-medium text-gray-700 mb-1">Sipariş Notu (Opsiyonel)</label>
            <div class="relative">
                <i class="ri-chat-1-line ri-lg absolute left-3 top-3 text-gray-400"></i>
                <textarea id="order-notes" name="orderNotes" rows="2" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary text-sm" placeholder="Özel bir talebiniz veya ürünle ilgili ek bilgi..."></textarea>
            </div>
        </div>
    </div> 
    ```

**2. JavaScript Değişiklikleri (`calculator-script` içinde):**

Bu script'i oldukça kapsamlı bir şekilde güncelleyeceğiz.

Aşağıda `index.html` dosyasının tamamını, hem HTML'deki yeni `additional-order-details` bölümünü `<form>` içine yerleştirilmiş halde hem de `calculator-script`'in bu yeni mantıkla güncellenmiş halini içeren şekilde sunuyorum:

```html
<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getir Kıbrıs</title>
<script src="https://cdn.tailwindcss.com/3.4.16"></script>
<script>tailwind.config={theme:{extend:{colors:{primary:'#5d3ebc',secondary:'#ffd300'},borderRadius:{'none':'0px','sm':'4px',DEFAULT:'8px','md':'12px','lg':'16px','xl':'20px','2xl':'24px','3xl':'32px','full':'9999px','button':'8px'}}}}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
<style>
/* Kullanıcının eklediği CSS kuralı */
:where([class^="ri-"])::before { content: "\f3c2"; }
body {
font-family: 'Inter', sans-serif;
background-color: #f9f9f9;
}
.copy-btn:active {
transform: scale(0.95);
}
</style>
</head>
<body class="bg-gray-50">
<div class="w-full max-w-screen-lg mx-auto relative min-h-screen pb-16">

<header class="fixed top-0 w-full bg-white shadow-sm z-50 px-4 py-3 flex items-center">
    <div class="flex-1">
        </div>
    <div class="flex flex-col items-center"> <img src="https://static.readdy.ai/image/d4cf8783f5bb2724d5eb1b66ee82374b/8de9178d5e8d147b21dbfa093538290a.png" alt="Getir Kıbrıs" class="h-12">
        <a href="index.html" data-readdy="true" class="text-sm font-medium text-primary mt-1">Ana Sayfa</a>
    </div>
    <div class="flex-1 flex justify-end"> <div id="auth-button" class="w-8 h-8 flex items-center justify-center">
            <button id="login-btn" class="text-xs text-primary font-medium cursor-pointer">
                <i class="ri-google-fill ri-lg"></i>
            </button>
            <div id="profile-container" class="hidden">
                <img id="profile-img" src="" alt="Profil" class="w-8 h-8 rounded-full cursor-pointer">
            </div>
        </div>
    </div>
</header>

<main class="pt-16 pb-20">
<div class="relative w-full h-64 sm:h-80 lg:h-[450px] overflow-hidden mb-6">
<video class="w-full h-full object-cover" controls poster="https://readdy.ai/api/search-image?query=online%20shopping%20and%20delivery%20service%2C%20modern%20lifestyle%2C%20soft%20lighting%2C%20clean%20background%2C%20banner%20image&width=800&height=400&seq=1&orientation=landscape">
<source src="https://public.readdy.ai/assets/sample.mp4" type="video/mp4">
Your browser does not support the video tag.
</video>
<div class="absolute inset-0 bg-gradient-to-t from-primary/70 to-transparent pointer-events-none"></div>
</div>

<div class="grid grid-cols-2 md:grid-cols-4 gap-4 px-4 mb-8">
<button id="calculate-btn" class="bg-white shadow-md p-4 rounded-button flex flex-col items-center justify-center h-32 cursor-pointer border border-gray-100 hover:border-primary/20 transition-all">
<div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2">
<i class="ri-calculator-line ri-xl text-primary"></i>
</div>
<span class="text-sm font-medium">Hesapla</span>
</button>
<a href="https://getirkibris.com/order.html" data-readdy="true" id="order-btn" class="bg-white shadow-md p-4 rounded-button flex flex-col items-center justify-center h-32 cursor-pointer border border-gray-100 hover:border-primary/20 transition-all">
<div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2">
<i class="ri-shopping-cart-line ri-xl text-primary"></i>
</div>
<span class="text-sm font-medium">Sipariş Ver (Link)</span> </a>
<a href="https://getirkibris.com/sepet.html" data-readdy="true" id="my-orders-btn" class="bg-white shadow-md p-4 rounded-button flex flex-col items-center justify-center h-32 cursor-pointer border border-gray-100 hover:border-primary/20 transition-all">
<div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2">
<i class="ri-file-list-3-line ri-xl text-primary"></i>
</div>
<span class="text-sm font-medium">Siparişlerim</span>
</a>
<a href="https://getirkibris.com/takip.html" data-readdy="true" id="track-btn" class="bg-white shadow-md p-4 rounded-button flex flex-col items-center justify-center h-32 cursor-pointer border border-gray-100 hover:border-primary/20 transition-all">
<div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2">
<i class="ri-truck-line ri-xl text-primary"></i>
</div>
<span class="text-sm font-medium">Kargo Takip</span>
</a>
</div>

<div id="calculator-section" class="bg-white rounded-lg shadow-md mx-4 p-4 mb-8 hidden">
<h3 class="text-lg font-semibold mb-4 text-primary">Ürün Maliyeti Hesapla ve Sipariş Ver</h3>
<form id="calculator-form" class="space-y-4">
    <div>
        <label for="order-method" class="block text-sm font-medium text-gray-700 mb-1">Sipariş Yöntemi</label>
        <div class="relative mb-4">
            <i class="ri-shopping-bag-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
            <select id="order-method" name="orderMethod" class="w-full pl-10 pr-10 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary appearance-none bg-white text-sm">
                <option value="" disabled selected>Sipariş yöntemi seçin</option>
                <option value="self">Ürünü ben sipariş edeceğim, sadece kargo hizmeti istiyorum</option>
                <option value="service">Ürünü benim yerime siz sipariş edin, size ödeme yapacağım</option>
            </select>
            <i class="ri-arrow-down-s-line ri-lg absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"></i>
        </div>
        <div>
            <label for="product-link" class="block text-sm font-medium text-gray-700 mb-1">Ürün Linki</label>
            <div class="relative">
                <i class="ri-link ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                <input type="url" id="product-link" name="productLink" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary" placeholder="https://www.example.com/urun">
            </div>
        </div>
    </div>
    <div>
        <label for="product-price" class="block text-sm font-medium text-gray-700 mb-1">Ürün Fiyatı (₺)</label>
        <div class="relative">
            <i class="ri-money-lira-circle-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
            <input type="number" id="product-price" name="productPrice" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary" placeholder="0.00" step="any">
        </div>
    </div>
    <div>
        <label for="product-category" class="block text-sm font-medium text-gray-700 mb-1">Kategori</label>
        <div class="relative">
            <i class="ri-price-tag-3-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
            <select id="product-category" name="productCategory" class="w-full pl-10 pr-10 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary appearance-none bg-white text-sm">
                <option value="" disabled selected>Kategori seçin</option>
                <option value="furniture">Mobilya</option>
                <option value="electronics">Elektronik</option>
                <option value="clothing">Giyim</option>
                <option value="cosmetics">Kozmetik</option>
                <option value="stationery">Kırtasiye</option>
            </select>
            <i class="ri-arrow-down-s-line ri-lg absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"></i>
        </div>
    </div>
    <div>
        <span class="block text-sm font-medium text-gray-700 mb-2">Teslimat Tipi</span>
        <div class="flex space-x-4">
            <label class="flex items-center cursor-pointer">
                <input type="radio" name="deliveryType" value="warehouse" class="sr-only" checked>
                <div class="w-5 h-5 border border-gray-300 rounded-full flex items-center justify-center mr-2 delivery-radio">
                    <div class="w-3 h-3 bg-primary rounded-full"></div> </div>
                <span class="text-sm">Depodan teslim</span>
            </label>
            <label class="flex items-center cursor-pointer">
                <input type="radio" name="deliveryType" value="home" class="sr-only">
                <div class="w-5 h-5 border border-gray-300 rounded-full flex items-center justify-center mr-2 delivery-radio">
                    <div class="w-3 h-3 bg-primary rounded-full hidden"></div>
                </div>
                <span class="text-sm">Eve teslim</span>
            </label>
        </div>
    </div>
    <div id="city-selection" class="hidden"> <label for="city" class="block text-sm font-medium text-gray-700 mb-1">Şehir</label>
        <div class="relative">
            <i class="ri-map-pin-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
            <select id="city" name="city" class="w-full pl-10 pr-10 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary appearance-none bg-white text-sm">
                <option value="" disabled selected>Şehir seçin</option>
                <option value="lefkosa">Lefkoşa</option>
                <option value="girne">Girne</option>
                <option value="magusa">Gazimağusa</option>
                <option value="guzelyurt">Güzelyurt</option>
                <option value="iskele">İskele</option>
            </select>
            <i class="ri-arrow-down-s-line ri-lg absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"></i>
        </div>
    </div>

    <div id="calculation-result" class="mt-6 p-4 bg-gray-50 rounded-lg hidden">
        <h4 class="font-medium text-gray-800 mb-2">Hesaplama Sonucu</h4>
        <div class="space-y-2 text-sm">
            <div class="flex justify-between">
                <span>Ürün Fiyatı:</span>
                <span id="result-price">0 ₺</span>
            </div>
            <div class="flex justify-between">
                <span>Kategori Ücreti:</span>
                <span id="result-category-fee">0 ₺</span>
            </div>
            <div class="flex justify-between hidden" id="result-city-row">
                <span>Teslimat Ücreti:</span>
                <span id="result-delivery-fee">0 ₺</span>
            </div>
            <div class="flex justify-between font-medium text-primary pt-2 border-t border-gray-200">
                <span>Genel Toplam:</span> <span id="result-total">0 ₺</span>
            </div>
        </div>
    </div>

    <div id="additional-order-details" class="mt-6 space-y-4 hidden border-t border-gray-200 pt-6">
        <h4 class="text-md font-semibold text-gray-700 mb-1">Ek Sipariş ve Teslimat Bilgileri</h4>
        <p class="text-xs text-gray-500 mb-4">Lütfen siparişinizi tamamlamak için aşağıdaki ek bilgileri doldurun.</p>

        <div>
            <label for="order-product-name" class="block text-sm font-medium text-gray-700 mb-1">Ürün Adı / Model / Renk / Beden</label>
            <div class="relative">
                <i class="ri-pencil-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                <input type="text" id="order-product-name" name="orderProductName" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary text-sm" placeholder="Örn: Kırmızı Elbise, M Beden">
            </div>
        </div>

        <div>
            <label for="order-quantity" class="block text-sm font-medium text-gray-700 mb-1">Adet</label>
            <div class="relative">
                <i class="ri-numbers-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                <input type="number" id="order-quantity" name="orderQuantity" value="1" min="1" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary text-sm">
            </div>
            <p class="text-xs text-gray-500 mt-1">Not: Mevcut hesaplama tek bir kargo paketi ücretini yansıtır.</p>
        </div>
        
        <div id="home-delivery-extra-fields" class="space-y-4"> <div>
                <label for="order-delivery-address" class="block text-sm font-medium text-gray-700 mb-1">Tam Teslimat Adresi (Kıbrıs)</label>
                <div class="relative">
                    <i class="ri-map-pin-user-line ri-lg absolute left-3 top-3 text-gray-400"></i>
                    <textarea id="order-delivery-address" name="orderDeliveryAddress" rows="3" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary text-sm" placeholder="Mahalle, Cadde/Sokak, Kapı No, Daire No"></textarea>
                </div>
                 <p class="text-xs text-gray-500 mt-1">Not: "Depodan Teslim" seçeneğinde bu alan zorunlu değildir, ancak iletişim için telefon numarası gereklidir.</p>
            </div>
        </div>

        <div class="mt-4">
            <label for="order-phone-number" class="block text-sm font-medium text-gray-700 mb-1">Telefon Numarası (Kıbrıs)</label>
            <div class="relative">
                <i class="ri-phone-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                <input type="tel" id="order-phone-number" name="orderPhoneNumber" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary text-sm" placeholder="+90 XXX XXX XX XX">
            </div>
        </div>
        
        <div>
            <label for="order-notes" class="block text-sm font-medium text-gray-700 mb-1">Sipariş Notu (Opsiyonel)</label>
            <div class="relative">
                <i class="ri-chat-1-line ri-lg absolute left-3 top-3 text-gray-400"></i>
                <textarea id="order-notes" name="orderNotes" rows="2" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary text-sm" placeholder="Özel bir talebiniz veya ürünle ilgili ek bilgi..."></textarea>
            </div>
        </div>
    </div>

    <button type="submit" class="w-full bg-primary text-white py-3 rounded-button font-medium hover:bg-primary/90 transition-colors cursor-pointer !rounded-button mt-2">
        Hesapla
    </button>
</form>
</div>


<div class="px-4 mb-8">
<h3 class="text-lg font-semibold mb-4">Popüler Alışveriş Siteleri</h3>
<div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4">
<a href="https://www.trendyol.com" target="_blank" class="bg-white rounded-lg shadow-sm p-3 h-20 flex items-center justify-center cursor-pointer border border-gray-100">
<img src="https://readdy.ai/api/search-image?query=trendyol%20logo%2C%20simple%2C%20clean%2C%20isolated%20on%20white%20background%2C%20centered%20composition&width=100&height=100&seq=2&orientation=squarish" alt="Trendyol" class="w-16 h-16 object-contain">
</a>
<a href="https://www.hepsiburada.com" target="_blank" class="bg-white rounded-lg shadow-sm p-3 h-20 flex items-center justify-center cursor-pointer border border-gray-100">
<img src="https://readdy.ai/api/search-image?query=hepsiburada%20logo%2C%20simple%2C%20clean%2C%20isolated%20on%20white%20background%2C%20centered%20composition&width=100&height=100&seq=3&orientation=squarish" alt="Hepsiburada" class="w-16 h-16 object-contain">
</a>
<a href="https://www.n11.com" target="_blank" class="bg-white rounded-lg shadow-sm p-3 h-20 flex items-center justify-center cursor-pointer border border-gray-100">
<img src="https://readdy.ai/api/search-image?query=n11%20logo%2C%20simple%2C%20clean%2C%20isolated%20on%20white%20background%2C%20centered%20composition&width=100&height=100&seq=4&orientation=squarish" alt="N11" class="w-16 h-16 object-contain">
</a>
<a href="https://www.amazon.com.tr" target="_blank" class="bg-white rounded-lg shadow-sm p-3 h-20 flex items-center justify-center cursor-pointer border border-gray-100">
<img src="https://readdy.ai/api/search-image?query=amazon%20logo%2C%20simple%2C%20clean%2C%20isolated%20on%20white%20background%2C%20centered%20composition&width=100&height=100&seq=5&orientation=squarish" alt="Amazon" class="w-16 h-16 object-contain">
</a>
<a href="https://www.ciceksepeti.com" target="_blank" class="bg-white rounded-lg shadow-sm p-3 h-20 flex items-center justify-center cursor-pointer border border-gray-100">
<img src="https://readdy.ai/api/search-image?query=ciceksepeti%20logo%2C%20simple%2C%20clean%2C%20isolated%20on%20white%20background%2C%20centered%20composition&width=100&height=100&seq=6&orientation=squarish" alt="ÇiçekSepeti" class="w-16 h-16 object-contain">
</a>
<a href="https://www.gittigidiyor.com" target="_blank" class="bg-white rounded-lg shadow-sm p-3 h-20 flex items-center justify-center cursor-pointer border border-gray-100">
<img src="https://readdy.ai/api/search-image?query=gittigidiyor%20logo%2C%20simple%2C%20clean%2C%20isolated%20on%20white%20background%2C%20centered%20composition&width=100&height=100&seq=7&orientation=squarish" alt="GittiGidiyor" class="w-16 h-16 object-contain">
</a>
</div>
</div>

<div class="bg-white rounded-lg shadow-md mx-4 p-4 mb-8">
<h3 class="text-lg font-semibold mb-4">Nasıl Çalışır?</h3>
<ol class="list-decimal pl-5 space-y-3 text-sm text-gray-700">
<li>Türkiye'deki herhangi bir siteden ürün seçin ve fiyatını hesaplayın.</li>
<li>Sipariş formunu doldurun ve ödemenizi yapın.</li>
<li>Ürünü kendi adınıza sipariş edin ve aşağıdaki teslimat adresini kullanın.</li>
</ol>
<div class="mt-4 p-3 bg-gray-50 rounded-lg relative">
<h4 class="text-sm font-medium mb-1">Teslimat Adresi</h4>
<p id="delivery-address" class="text-sm text-gray-700 pr-8">Getir Kıbrıs Depo, Mersin 10, Türkiye</p>
<button class="copy-btn absolute top-3 right-3 w-6 h-6 flex items-center justify-center text-primary cursor-pointer" data-copy="delivery-address">
<i class="ri-file-copy-line ri-lg"></i>
</button>
</div>
<div class="mt-3 p-3 bg-gray-50 rounded-lg relative">
<h4 class="text-sm font-medium mb-1">IBAN Bilgisi</h4>
<p id="iban-info" class="text-sm text-gray-700 pr-8">TR12 3456 7890 1234 5678 9012 34</p>
<button class="copy-btn absolute top-3 right-3 w-6 h-6 flex items-center justify-center text-primary cursor-pointer" data-copy="iban-info">
<i class="ri-file-copy-line ri-lg"></i>
</button>
</div>
<div class="mt-6">
<h4 class="text-lg font-semibold mb-4">İletişim Bilgileri</h4>
<div class="space-y-4">
<div class="flex items-start gap-3">
<div class="w-6 h-6 flex items-center justify-center text-primary">
<i class="ri-map-pin-2-line"></i>
</div>
<div>
<h5 class="font-medium text-gray-800">Adres</h5>
<p class="text-sm text-gray-600">Şehit Mustafa Ruso Caddesi, No:86, Lefkoşa, KKTC</p>
</div>
</div>
<div class="flex items-start gap-3">
<div class="w-6 h-6 flex items-center justify-center text-primary">
<i class="ri-phone-line"></i>
</div>
<div>
<h5 class="font-medium text-gray-800">Telefon</h5>
<p class="text-sm text-gray-600">+90 392 123 45 67</p>
</div>
</div>
<div class="flex items-start gap-3">
<div class="w-6 h-6 flex items-center justify-center text-primary">
<i class="ri-mail-line"></i>
</div>
<div>
<h5 class="font-medium text-gray-800">E-posta</h5>
<p class="text-sm text-gray-600">info@getirkibris.com</p>
</div>
</div>
</div>
<div class="mt-6 relative">
<div class="absolute top-4 left-4 z-10 bg-white px-4 py-2 rounded-lg shadow-md">
<h5 class="font-medium text-gray-800">Kıbrıs Adresimiz</h5>
</div>
<div class="w-full h-64 sm:h-80 lg:h-96 rounded-lg overflow-hidden">
<a href="https://www.google.com/maps/place/Pufemo/@35.2265014,33.4637806,17z/data=!3m1!4b1!4m6!3m5!1s0x14de3f74e0864075:0x5fa8b6333def3eb!8m2!3d35.2265014!4d33.4637806!16s%2Fg%2F11x5__k07t?entry=ttu&g_ep=EgoyMDI1MDUyOC4wIKXMDSoASAFQAw%3D%3D" data-readdy="true" target="_blank">
<img src="https://public.readdy.ai/gen_page/map_placeholder_1280x720.png" alt="Harita" class="w-full h-full object-cover">
</a>
</div>
</div>
<div class="mt-8 space-y-6">
<div>
<h4 class="text-lg font-semibold mb-4">Alışveriş İşlemleri</h4>
<div class="grid grid-cols-1 gap-4">
<div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
<div class="flex items-start gap-4">
<div class="w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0">
<i class="ri-shopping-cart-line text-primary"></i>
</div>
<div>
<h5 class="font-medium text-gray-800">Sipariş Verme</h5>
<p class="text-sm text-gray-600 mt-1">Türkiye'deki herhangi bir e-ticaret sitesinden ürün seçin, sipariş formunu doldurun ve ödemenizi yapın.</p>
</div>
</div>
</div>
<div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
<div class="flex items-start gap-4">
<div class="w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0">
<i class="ri-calculator-line text-primary"></i>
</div>
<div>
<h5 class="font-medium text-gray-800">Maliyet Hesaplama</h5>
<p class="text-sm text-gray-600 mt-1">Ürün fiyatı ve kategorisine göre toplam maliyeti hesaplayın, ek ücretleri önceden öğrenin.</p>
</div>
</div>
</div>
</div>
</div>
<div>
<h4 class="text-lg font-semibold mb-4">Teslimat ve Takip</h4>
<div class="grid grid-cols-1 gap-4">
<div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
<div class="flex items-start gap-4">
<div class="w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0">
<i class="ri-truck-line text-primary"></i>
</div>
<div>
<h5 class="font-medium text-gray-800">Kargo Takibi</h5>
<p class="text-sm text-gray-600 mt-1">Siparişinizin durumunu anlık olarak takip edin, teslimat sürecini kontrol edin.</p>
</div>
</div>
</div>
<div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
<div class="flex items-start gap-4">
<div class="w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0">
<i class="ri-map-pin-line text-primary"></i>
</div>
<div>
<h5 class="font-medium text-gray-800">Teslimat Seçenekleri</h5>
<p class="text-sm text-gray-600 mt-1">Depodan teslim veya adrese teslimat seçeneklerinden size uygun olanı seçin.</p>
</div>
</div>
</div>
</div>
</div>
<div>
<h4 class="text-lg font-semibold mb-4">Müşteri Hizmetleri</h4>
<div class="grid grid-cols-1 gap-4">
<div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
<div class="flex items-start gap-4">
<div class="w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0">
<i class="ri-customer-service-line text-primary"></i>
</div>
<div>
<h5 class="font-medium text-gray-800">7/24 Destek</h5>
<p class="text-sm text-gray-600 mt-1">WhatsApp üzerinden bize ulaşın, sorularınızı yanıtlayalım, sorunlarınıza çözüm bulalım.</p>
</div>
</div>
</div>
<div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100">
<div class="flex items-start gap-4">
<div class="w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center flex-shrink-0">
<i class="ri-file-list-3-line text-primary"></i>
</div>
<div>
<h5 class="font-medium text-gray-800">Sipariş Geçmişi</h5>
<p class="text-sm text-gray-600 mt-1">Tüm siparişlerinizi görüntüleyin, geçmiş alışverişlerinizi kontrol edin.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</main>
</div> <a href="https://wa.me/905391090879" target="_blank" data-readdy="true" class="fixed bottom-20 right-4 z-50 bg-[#25D366] w-12 h-12 rounded-full shadow-lg flex items-center justify-center hover:bg-[#20bd5a] transition-colors">
<i class="ri-whatsapp-line ri-xl text-white"></i>
</a>
<div class="mt-8 px-4 pb-20 text-center">
<div class="space-x-4">
<a href="#" class="text-xs text-gray-600 hover:text-primary">Gizlilik Politikası</a>
<a href="#" class="text-xs text-gray-600 hover:text-primary">Kullanım Şartları</a>
<a href="#" class="text-xs text-gray-600 hover:text-primary">S.S.S.</a>
</div>
</div>
<div id="login-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-[60] hidden">
<div class="bg-white rounded-lg p-6 w-[320px] relative">
<button id="close-login-modal" class="absolute top-3 right-3 text-gray-400 hover:text-gray-600 cursor-pointer">
<i class="ri-close-line ri-lg"></i>
</button>
<div class="text-center mb-6">
<h3 class="text-xl font-semibold text-gray-800">Giriş Yap</h3>
<p class="text-sm text-gray-600 mt-1">Hizmetlerimizi kullanmak için giriş yapın</p>
</div>
<button id="google-login-btn" class="w-full flex items-center justify-center gap-2 border border-gray-300 rounded-button py-3 font-medium hover:bg-gray-50 transition-colors cursor-pointer">
<i class="ri-google-fill ri-lg text-primary"></i>
<span>Google ile Giriş Yap</span>
</button>
</div>
</div>
<div id="auth-required-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-[60] hidden">
<div class="bg-white rounded-lg p-6 w-[320px]">
<div class="text-center mb-6">
<div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
<i class="ri-lock-line ri-2x text-red-500"></i>
</div>
<h3 class="text-xl font-semibold text-gray-800">Giriş Gerekli</h3>
<p class="text-sm text-gray-600 mt-2">Bu özelliği kullanmak için lütfen giriş yapın.</p>
</div>
<button id="auth-login-btn" class="w-full bg-primary text-white py-3 rounded-button font-medium hover:bg-primary/90 transition-colors cursor-pointer !rounded-button">
Giriş Yap
</button>
<button id="close-auth-modal" class="w-full text-gray-600 py-2 mt-2 font-medium hover:text-gray-800 transition-colors cursor-pointer">
Kapat
</button>
</div>
</div>
<div id="toast" class="fixed bottom-20 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-4 py-2 rounded-lg opacity-0 transition-opacity duration-300 z-[70]">
<span id="toast-message">Kopyalandı!</span>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script> <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCHms5Y5x-KOu3Y43FrfRoljmW_4m3H4yY",
    authDomain: "kibris-6b4f7.firebaseapp.com",
    projectId: "kibris-6b4f7",
    storageBucket: "kibris-6b4f7.appspot.com", 
    messagingSenderId: "141262926171",
    appId: "1:141262926171:web:07226845e51d4bbc0dea7e",
    measurementId: "G-JL9P6BRZTD"
  };
  firebase.initializeApp(firebaseConfig);
  const analytics = firebase.analytics();
  const db = firebase.firestore(); // Firestore örneği
</script>

<script id="auth-script">
document.addEventListener('DOMContentLoaded', function() {
    const auth = firebase.auth(); 
    const loginBtn = document.getElementById('login-btn');
    const profileContainer = document.getElementById('profile-container');
    const profileImg = document.getElementById('profile-img');
    const loginModal = document.getElementById('login-modal');
    const closeLoginModal = document.getElementById('close-login-modal');
    const googleLoginBtn = document.getElementById('google-login-btn');
    const authRequiredModal = document.getElementById('auth-required-modal');
    const authLoginBtn = document.getElementById('auth-login-btn');
    const closeAuthModal = document.getElementById('close-auth-modal');

    auth.onAuthStateChanged(function(user) {
        updateAuthUI(user); 
    });

    loginBtn.addEventListener('click', () => loginModal.classList.remove('hidden'));
    closeLoginModal.addEventListener('click', () => loginModal.classList.add('hidden'));

    googleLoginBtn.addEventListener('click', function() {
        const provider = new firebase.auth.GoogleAuthProvider();
        auth.signInWithPopup(provider)
          .then(() => {
            loginModal.classList.add('hidden');
            if(window.showToast) window.showToast('Google ile giriş başarılı!'); 
          })
          .catch((error) => {
            console.error("Google ile giriş hatası:", error.code, error.message);
            if(window.showToast) window.showToast('Giriş sırasında bir hata oluştu: ' + error.message); 
          });
    });

    window.showAuthRequiredModal = function() {
        authRequiredModal.classList.remove('hidden');
    }
    closeAuthModal.addEventListener('click', () => authRequiredModal.classList.add('hidden'));
    authLoginBtn.addEventListener('click', () => {
        authRequiredModal.classList.add('hidden');
        loginModal.classList.remove('hidden'); 
    });

    function updateAuthUI(user) { 
        if (user) { 
            loginBtn.classList.add('hidden');
            profileContainer.classList.remove('hidden');
            profileImg.src = user.photoURL || 'https://via.placeholder.com/150'; 
            profileImg.alt = user.displayName || user.email || 'Profil'; 
        } else {
            loginBtn.classList.remove('hidden');
            profileContainer.classList.add('hidden');
        }
    }

    profileContainer.addEventListener('click', function() {
        if (confirm('Çıkış yapmak istediğinize emin misiniz?')) {
            auth.signOut().then(() => {
                if(window.showToast) window.showToast('Çıkış yapıldı'); 
            }).catch((error) => {
                console.error('Çıkış hatası:', error);
                if(window.showToast) window.showToast('Çıkış sırasında bir hata oluştu.'); 
            });
        }
    });

    // index.html'deki diğer butonlar için koruma (order-btn, my-orders-btn, track-btn)
    // Bu butonların ID'leri ve href'leri index.html'de tanımlı olduğu gibi kalmalı
    const protectedLinkButtons = [
        document.getElementById('order-btn'),      // Bu ID'li link artık bu sayfada farklı bir amaç için kullanılmayacak,
                                                  // sipariş formu bu sayfanın içinde. Ancak link olarak kalabilir veya kaldırılabilir.
                                                  // Şimdilik "Sipariş Ver (Link)" olarak bıraktım, belki ileride ayrı bir sipariş listeleme sayfasına gider.
        document.getElementById('my-orders-btn'),
        document.getElementById('track-btn')
    ];

    protectedLinkButtons.forEach(button => {
        if (button && button.tagName === 'A') { // Sadece A etiketlerini kontrol et
            button.addEventListener('click', function(e) {
                if (!auth.currentUser) { 
                    e.preventDefault(); // Linke gitmesini engelle
                    window.showAuthRequiredModal(); 
                }
            });
        }
    });


    const calculateBtn = document.getElementById('calculate-btn'); // Hesapla ana butonu
    if (calculateBtn) {
        calculateBtn.addEventListener('click', function() {
            if (window.toggleCalculatorSection) {
                window.toggleCalculatorSection();
            }
        });
    }
});
</script>

<script id="calculator-script">
document.addEventListener('DOMContentLoaded', function() {
    const calculatorSection = document.getElementById('calculator-section');
    const calculatorForm = document.getElementById('calculator-form');
    const citySelection = document.getElementById('city-selection');
    const deliveryRadios = document.querySelectorAll('input[name="deliveryType"]'); // name attribute güncellendi
    const calculationResultDiv = document.getElementById('calculation-result');
    const resultCityRow = document.getElementById('result-city-row');
    const resultPriceDisplay = document.getElementById('result-price');
    
    const additionalOrderDetailsDiv = document.getElementById('additional-order-details');
    const homeDeliveryExtraFieldsDiv = document.getElementById('home-delivery-extra-fields');

    const submitButton = calculatorForm.querySelector('button[type="submit"]');
    let formMode = 'calculate'; // Olası modlar: 'calculate', 'orderDetails', 'submitOrder'

    const allCalculatorInputs = [
        document.getElementById('order-method'),
        document.getElementById('product-link'),
        document.getElementById('product-price'),
        document.getElementById('product-category'),
        ...calculatorForm.querySelectorAll('input[name="deliveryType"]'),
        document.getElementById('city')
    ];
    
    const additionalOrderInputs = [
        document.getElementById('order-product-name'),
        document.getElementById('order-quantity'),
        document.getElementById('order-delivery-address'),
        document.getElementById('order-phone-number'),
        document.getElementById('order-notes')
    ];

    window.toggleCalculatorSection = function() {
        calculatorSection.classList.toggle('hidden');
        if (!calculatorSection.classList.contains('hidden')) {
            resetToInitialCalculatorState(); // Hesaplama bölümü açıldığında her şeyi sıfırla
            calculatorSection.scrollIntoView({ behavior: 'smooth' });
        }
    };

    function resetToInitialCalculatorState() {
        calculatorForm.reset(); // Formdaki tüm inputları (hesaplama ve ek detaylar) sıfırlar
        
        // Radyo buton UI'ını ve şehir görünürlüğünü ayarla
        const defaultDeliveryType = document.querySelector('input[name="deliveryType"][value="warehouse"]');
        if (defaultDeliveryType) {
            defaultDeliveryType.checked = true; // Default'u seçili yap
            // UI güncellemesi için event'i tetikle
            const changeEvent = new Event('change');
            defaultDeliveryType.dispatchEvent(changeEvent);
        }
        
        submitButton.textContent = 'Hesapla';
        formMode = 'calculate';
        calculationResultDiv.classList.add('hidden');
        additionalOrderDetailsDiv.classList.add('hidden');
        homeDeliveryExtraFieldsDiv.style.display = 'none'; // Başlangıçta gizle (eve teslim seçilirse JS ile gösterilecek)
    }
    
    function resetForNewCalculation() {
        submitButton.textContent = 'Hesapla';
        formMode = 'calculate';
        calculationResultDiv.classList.add('hidden');
        additionalOrderDetailsDiv.classList.add('hidden');
        
        // Ek sipariş alanlarını temizle (isteğe bağlı, resetToInitialCalculatorState zaten formu resetliyor)
        additionalOrderInputs.forEach(input => {
            if(input.type === 'number' && input.id === 'order-quantity') input.value = '1';
            else if (input.tagName.toLowerCase() !== 'button') input.value = '';
        });
        homeDeliveryExtraFieldsDiv.style.display = 'none';
    }


    allCalculatorInputs.forEach(input => {
        input.addEventListener('change', resetForNewCalculation);
        if (input.type === 'text' || input.type === 'number' || input.type === 'url' || input.tagName.toLowerCase() === 'select') {
            input.addEventListener('input', resetForNewCalculation); // select için input yerine change daha iyi ama burada da kalsın
        }
    });
    
    deliveryRadios.forEach(radio => {
        radio.addEventListener('change', function() {
            document.querySelectorAll('.delivery-radio div').forEach(dot => dot.classList.add('hidden'));
            const parentLabel = this.closest('label');
            if (parentLabel) {
                 const radioDiv = parentLabel.querySelector('.delivery-radio div');
                 if (radioDiv) radioDiv.classList.remove('hidden');
            }

            if (this.value === 'home') {
                citySelection.classList.remove('hidden');
                homeDeliveryExtraFieldsDiv.style.display = 'block'; // Eve teslimde ek adres alanını göster
            } else {
                citySelection.classList.add('hidden');
                homeDeliveryExtraFieldsDiv.style.display = 'none'; // Depodan teslimde ek adres alanını gizle
            }
            resetForNewCalculation(); // Teslimat tipi değişince de sıfırla
        });
    });
    
    // Sayfa ilk yüklendiğinde UI ayarları
    const initiallyCheckedRadio = document.querySelector('input[name="deliveryType"]:checked');
    if (initiallyCheckedRadio) {
        const parentLabel = initiallyCheckedRadio.closest('label');
        if(parentLabel) {
            const radioDiv = parentLabel.querySelector('.delivery-radio div');
            if (radioDiv) radioDiv.classList.remove('hidden');
        }
        if (initiallyCheckedRadio.value === 'home') {
            citySelection.classList.remove('hidden');
            homeDeliveryExtraFieldsDiv.style.display = 'block';
        } else {
            citySelection.classList.add('hidden');
            homeDeliveryExtraFieldsDiv.style.display = 'none';
        }
    } else { // Eğer default checked yoksa, warehouse'u ayarla
        const warehouseRadio = document.querySelector('input[name="deliveryType"][value="warehouse"]');
        if(warehouseRadio) {
            warehouseRadio.checked = true;
            const changeEvent = new Event('change', { bubbles: true }); // Event'i tetikle
            warehouseRadio.dispatchEvent(changeEvent);
        }
    }


    calculatorForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const auth = firebase.auth();

        if (formMode === 'calculate') {
            // --- AŞAMA 1: HESAPLAMA ---
            const orderMethod = document.getElementById('order-method').value;
            const price = parseFloat(document.getElementById('product-price').value) || 0;
            const category = document.getElementById('product-category').value;
            const deliveryType = document.querySelector('input[name="deliveryType"]:checked').value;
            const city = document.getElementById('city').value;

            if (!orderMethod) { window.showToast('Lütfen sipariş yöntemi seçin'); return; }
            if (price <= 0) { window.showToast('Lütfen geçerli bir ürün fiyatı girin (0\'dan büyük).'); return; }
            if (!category) { window.showToast('Lütfen bir kategori seçin'); return; }
            if (deliveryType === 'home' && !city) { window.showToast('Lütfen bir şehir seçin'); return; }

            const categoryRates = { /* ... (orijinaldeki gibi) ... */ 'furniture': 0.70, 'electronics': 0.70, 'clothing': 0.45, 'cosmetics': 0.70, 'stationery': 0.40 };
            const cityFees = { /* ... (orijinaldeki gibi) ... */ 'lefkosa': 200, 'girne': 350, 'magusa': 300, 'guzelyurt': 400, 'iskele': 450 };

            const categoryFee = price * (categoryRates[category] || 0);
            let deliveryFee = 0;
            if (deliveryType === 'home') {
                deliveryFee = cityFees[city] || 0;
                resultCityRow.classList.remove('hidden');
            } else {
                resultCityRow.classList.add('hidden');
            }

            let total;
            if (orderMethod === 'self') {
                total = categoryFee + deliveryFee;
                resultPriceDisplay.innerHTML = `${price.toFixed(2)} ₺ <span class="text-xs text-gray-500">(ürün bedeli size ait)</span>`;
            } else { 
                total = price + categoryFee + deliveryFee;
                resultPriceDisplay.textContent = `${price.toFixed(2)} ₺`;
            }

            document.getElementById('result-category-fee').textContent = `${categoryFee.toFixed(2)} ₺`;
            document.getElementById('result-delivery-fee').textContent = `${deliveryFee.toFixed(2)} ₺`;
            document.getElementById('result-total').textContent = `${total.toFixed(2)} ₺`; 

            calculationResultDiv.classList.remove('hidden');
            calculationResultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            
            submitButton.textContent = 'Sipariş Ver';
            formMode = 'orderDetails';

        } else if (formMode === 'orderDetails') {
            // --- AŞAMA 2: EK DETAYLARI GÖSTER (Sipariş Ver butonuna ilk tıklama) ---
            if (!auth.currentUser) {
                if (window.showAuthRequiredModal) window.showAuthRequiredModal();
                else alert('Sipariş işlemine devam etmek için lütfen giriş yapın.');
                return;
            }
            additionalOrderDetailsDiv.classList.remove('hidden');
            // Teslimat tipine göre adres alanını ayarla
            const currentDeliveryType = document.querySelector('input[name="deliveryType"]:checked').value;
            if (currentDeliveryType === 'home') {
                homeDeliveryExtraFieldsDiv.style.display = 'block';
            } else {
                homeDeliveryExtraFieldsDiv.style.display = 'none';
            }
            submitButton.textContent = 'Siparişi Onayla';
            formMode = 'submitOrder';
            additionalOrderDetailsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        
        } else if (formMode === 'submitOrder') {
            // --- AŞAMA 3: SİPARİŞİ GÖNDER (Siparişi Onayla butonuna tıklama) ---
            if (!auth.currentUser) { // Tekrar kontrol (gerekirse)
                if (window.showAuthRequiredModal) window.showAuthRequiredModal();
                else alert('Sipariş göndermek için lütfen giriş yapın.');
                return;
            }

            const orderData = {
                // Hesaplama formundan veriler
                orderMethod: document.getElementById('order-method').value,
                productLink: document.getElementById('product-link').value,
                productPriceCalculated: parseFloat(document.getElementById('product-price').value) || 0, // Hesaplamada kullanılan fiyat
                productCategory: document.getElementById('product-category').value,
                deliveryType: document.querySelector('input[name="deliveryType"]:checked').value,
                cityForDeliveryFee: document.getElementById('city').value, // Teslimat ücreti için kullanılan şehir
                
                // Hesaplanan ücretler
                calculatedCategoryFee: parseFloat(document.getElementById('result-category-fee').textContent) || 0,
                calculatedDeliveryFee: parseFloat(document.getElementById('result-delivery-fee').textContent) || 0,
                calculatedTotal: parseFloat(document.getElementById('result-total').textContent) || 0,

                // Ek sipariş detaylarından veriler
                productName: document.getElementById('order-product-name').value.trim(),
                quantity: parseInt(document.getElementById('order-quantity').value) || 1,
                deliveryAddressFull: document.getElementById('order-delivery-address').value.trim(), // Tam adres
                phoneNumber: document.getElementById('order-phone-number').value.trim(),
                orderNotes: document.getElementById('order-notes').value.trim(),
                
                // Kullanıcı ve zaman damgası
                userId: auth.currentUser.uid,
                userEmail: auth.currentUser.email,
                userName: auth.currentUser.displayName || '',
                orderTimestamp: firebase.firestore.FieldValue.serverTimestamp(),
                status: 'Yeni Sipariş' // Siparişin başlangıç durumu
            };

            // Ek alanlar için doğrulamalar
            if (!orderData.productName) {
                window.showToast('Lütfen ürün adı/modeli gibi detayları girin.');
                document.getElementById('order-product-name').focus(); return;
            }
            if (!orderData.phoneNumber) { 
                window.showToast('Lütfen geçerli bir telefon numarası girin.');
                document.getElementById('order-phone-number').focus(); return;
            }
            if (orderData.deliveryType === 'home' && !orderData.deliveryAddressFull) {
                 window.showToast('Eve teslimat için lütfen tam adresinizi girin.');
                 document.getElementById('order-delivery-address').focus(); return;
            }
            // Gerekirse daha detaylı telefon ve adres doğrulaması eklenebilir.

            console.log("Gönderilecek Sipariş Verileri:", orderData);
            submitButton.disabled = true;
            submitButton.textContent = 'Gönderiliyor...';

            db.collection('orders').add(orderData)
              .then((docRef) => {
                  if(window.showToast) window.showToast('Siparişiniz başarıyla alındı! ID: ' + docRef.id);
                  resetToInitialCalculatorState(); // Her şeyi sıfırla
              })
              .catch((error) => {
                  console.error("Sipariş Firestore'a kaydedilirken hata: ", error);
                  if(window.showToast) window.showToast('Sipariş gönderilirken bir hata oluştu.');
              })
              .finally(() => {
                  submitButton.disabled = false;
                  // resetToInitialCalculatorState zaten buton metnini "Hesapla" yapıyor.
              });
        }
    });
});
</script>

<script id="utils-script">
document.addEventListener('DOMContentLoaded', function() {
    window.showToast = function(message) {
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toast-message');
        if (!toast || !toastMessage) return;
        toastMessage.textContent = message;
        toast.classList.remove('opacity-0');
        toast.classList.add('opacity-100');
        setTimeout(() => {
            toast.classList.remove('opacity-100');
            toast.classList.add('opacity-0');
        }, 3000);
    };

    const copyButtons = document.querySelectorAll('.copy-btn');
    copyButtons.forEach(button => {
        button.addEventListener('click', function() {
            const targetId = this.getAttribute('data-copy');
            const textToCopy = document.getElementById(targetId).textContent;
            navigator.clipboard.writeText(textToCopy)
            .then(() => {
                if(window.showToast) window.showToast('Kopyalandı!');
            })
            .catch(err => {
                if(window.showToast) window.showToast('Kopyalama başarısız');
                console.error('Kopyalama hatası:', err);
            });
        });
    });
});
</script>
</body>
</html>
