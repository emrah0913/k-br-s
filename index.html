<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Getir Kıbrıs - Anasayfa</title>
  <script src="https://cdn.tailwindcss.com/3.4.16"></script>
  <script>tailwind.config={theme:{extend:{colors:{primary:'#5d3ebc',secondary:'#ffd300'},borderRadius:{'none':'0px','sm':'4px',DEFAULT:'8px','md':'12px','lg':'16px','xl':'20px','2xl':'24px','3xl':'32px','full':'9999px','button':'8px'}}}}</script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
  <style>
    body {
      font-family: 'Inter', sans-serif; /* Fallback to Inter if Pacifico is not preferred for body text */
      background-color: #f0f2f5;
      color: #333;
    }
    .font-pacifico {
      font-family: 'Pacifico', cursive;
    }
    .hidden {
      display: none !important;
    }
    /* Custom Toast CSS - Tailwind ile de entegre edilebilir ancak bu basit bir örnek */
    #toast {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: rgba(51, 51, 51, 0.9);
        color: #fff;
        padding: 10px 20px;
        border-radius: 8px;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
        z-index: 1000;
        text-align: center;
    }
    #toast.opacity-100 {
        opacity: 1;
    }
  </style>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body class="bg-gray-100">
  <header class="bg-primary text-white p-4 flex justify-between items-center shadow-md">
    <div class="flex items-center space-x-2">
      <img src="https://getir.com/images/getir-logo.svg" alt="Getir Logo" class="h-8">
      <h1 class="text-xl font-bold font-pacifico">Getir Kıbrıs</h1>
    </div>
    <nav class="flex space-x-4">
      <a href="index.html" class="hover:text-secondary transition-colors duration-200">Anasayfa</a>
      <a href="siparisver.html" id="siparisVerLink" class="hover:text-secondary transition-colors duration-200 hidden">Sipariş Ver</a>
      <a href="siparislerim.html" id="siparislerimLink" class="hover:text-secondary transition-colors duration-200 hidden">Siparişlerim</a>
      <a href="kargotakip.html" id="kargoTakipLink" class="hover:text-secondary transition-colors duration-200 hidden">Kargo Takip</a>
      <a href="admin.html" id="adminLink" class="hover:text-secondary transition-colors duration-200 hidden">Admin Paneli</a>
      <a href="#" id="loginRegisterLink" class="hover:text-secondary transition-colors duration-200">Giriş Yap / Kayıt Ol</a>
      <a href="#" id="logoutLink" class="hover:text-secondary transition-colors duration-200 hidden">Çıkış Yap</a>
    </nav>
  </header>

  <div id="auth-status" class="text-center mt-4 text-primary font-semibold"></div>

  <main class="container mx-auto px-4 py-8">
    <section class="bg-white p-8 rounded-lg shadow-md mb-8">
      <h2 class="text-3xl font-bold text-center text-primary mb-6">Türkiye'den Kıbrıs'a Hızlı ve Güvenilir Teslimat</h2>
      <p class="text-gray-700 text-lg text-center mb-6 max-w-2xl mx-auto">Getir Kıbrıs ile Türkiye'den dilediğiniz ürünü kapınıza kadar getirin. Hızlı kargo, uygun fiyatlar ve güvenilir hizmet.</p>
      <div class="text-center">
        <button onclick="location.href='siparisver.html'" class="bg-secondary text-primary px-8 py-3 rounded-button font-semibold hover:bg-yellow-400 transition-colors duration-300">Hemen Sipariş Ver</button>
      </div>
    </section>

    <section class="bg-white p-8 rounded-lg shadow-md">
      <h2 class="text-2xl font-bold text-primary mb-6 text-center">Kargo Fiyatı Hesapla</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <label for="price" class="block text-gray-700 text-sm font-bold mb-2">Ürün Fiyatı (TL):</label>
          <input type="number" id="price" placeholder="Ürün fiyatını girin" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
        </div>
        <div>
          <label for="category" class="block text-gray-700 text-sm font-bold mb-2">Ürün Kategorisi:</label>
          <select id="category" class="shadow border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
            <option value="mobilya">Mobilya</option>
            <option value="giyim">Giyim</option>
            <option value="elektronik">Elektronik</option>
            <option value="diger">Diğer</option>
          </select>
        </div>
        <div>
          <label for="delivery" class="block text-gray-700 text-sm font-bold mb-2">Teslimat Şekli:</label>
          <select id="delivery" class="shadow border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
            <option value="depo">Depodan Alacağım</option>
            <option value="eve">Eve Teslim</option>
          </select>
        </div>
        <div id="citySelect" class="hidden">
          <label for="city" class="block text-gray-700 text-sm font-bold mb-2">Şehir:</label>
          <select id="city" class="shadow border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
            <option value="lefkoşa">Lefkoşa</option>
            <option value="girne">Girne</option>
            <option value="gazimağusa">Gazimağusa</option>
            <option value="güzelyurt">Güzelyurt</option>
            <option value="iskele">İskele</option>
          </select>
        </div>
      </div>
      <button onclick="calculate()" class="bg-primary hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-button mt-6 w-full transition-colors duration-300">Hesapla</button>
      <div id="result" class="result bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mt-4 text-center text-lg font-semibold hidden"></div>
    </section>
  </main>

  <footer class="bg-gray-800 text-white text-center p-4 mt-8">
    <p>&copy; 2025 Getir Kıbrıs. Tüm hakları saklıdır.</p>
  </footer>

  <div id="toast" class="opacity-0"></div>

  <script>
    // Firebase yapılandırması
    const firebaseConfig = {
      apiKey: "AIzaSyCHms5Y5x-KOu3Y43FrfRoljmW_4m3H4yY",
      authDomain: "kibris-6b4f7.firebaseapp.com",
      projectId: "kibris-6b4f7",
      storageBucket: "kibris-6b4f7.firebasestorage.app",
      messagingSenderId: "141262926171",
      appId: "1:141262926171:web:07226845e51d4bbc0dea7e",
      measurementId: "G-JL9P6BRZTD"
    };

    // Firebase'i başlat
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const delivery = document.getElementById("delivery");
    const citySelect = document.getElementById("citySelect");
    const authStatusDiv = document.getElementById("auth-status");
    const loginRegisterLink = document.getElementById("loginRegisterLink");
    const logoutLink = document.getElementById("logoutLink");
    const siparisVerLink = document.getElementById("siparisVerLink");
    const siparislerimLink = document.getElementById("siparislerimLink");
    const kargoTakipLink = document.getElementById("kargoTakipLink");
    const adminLink = document.getElementById("adminLink");
    const resultDiv = document.getElementById("result");


    const ADMIN_UID = 'JKy2CJircqSgC8ftIx9kY7iHlXC3'; // Admin kullanıcısının UID'si

    delivery.addEventListener("change", () => {
      if (delivery.value === "eve") {
        citySelect.classList.remove("hidden");
      } else {
        citySelect.classList.add("hidden");
      }
    });

    function calculate() {
      const price = parseFloat(document.getElementById("price").value) || 0;
      const category = document.getElementById("category").value;
      const deliveryType = document.getElementById("delivery").value;
      const city = document.getElementById("city").value;
      let oran = 0;
      let cityPrice = 0;

      switch (category) {
        case "mobilya": oran = 0.7; break;
        case "giyim": oran = 0.45; break;
        case "elektronik": oran = 0.7; break;
        case "diger": oran = 0.5; break;
      }

      if (deliveryType === "eve") {
        switch (city) {
          case "lefkoşa": cityPrice = 200; break;
          case "girne": cityPrice = 300; break;
          case "gazimağusa": cityPrice = 250; break;
          case "güzelyurt": cityPrice = 180; break;
          case "iskele": cityPrice = 280; break;
        }
      }

      const total = (price * oran) + cityPrice;
      resultDiv.textContent = `Tahmini Kargo Ücreti: ${total.toFixed(2)} TL`;
      resultDiv.classList.remove("hidden");
    }

    // Oturum durumu izleyicisi
    auth.onAuthStateChanged(user => {
      if (user) {
        authStatusDiv.textContent = `Hoş geldiniz, ${user.email}!`;
        loginRegisterLink.classList.add("hidden");
        logoutLink.classList.remove("hidden");
        siparisVerLink.classList.remove("hidden");
        siparislerimLink.classList.remove("hidden");
        kargoTakipLink.classList.remove("hidden");

        // Admin kontrolü
        if (user.uid === ADMIN_UID) {
          adminLink.classList.remove("hidden");
        } else {
          adminLink.classList.add("hidden");
        }

      } else {
        authStatusDiv.textContent = "Giriş yapmadınız.";
        loginRegisterLink.classList.remove("hidden");
        logoutLink.classList.add("hidden");
        siparisVerLink.classList.add("hidden");
        siparislerimLink.classList.add("hidden");
        kargoTakipLink.classList.add("hidden");
        adminLink.classList.add("hidden");
      }
    });

    // Çıkış yapma fonksiyonu
    logoutLink.addEventListener("click", (e) => {
      e.preventDefault();
      auth.signOut().then(() => {
        showToast("Başarıyla çıkış yapıldı.");
      }).catch((error) => {
        showToast("Çıkış yapılırken hata oluştu: " + error.message);
      });
    });

    // Giriş/Kayıt Linki için basılı tutma özelliği
    let longPressTimer;
    loginRegisterLink.addEventListener('mousedown', (e) => {
      longPressTimer = setTimeout(() => {
        const email = prompt("Lütfen e-posta adresinizi girin:");
        const password = prompt("Lütfen şifrenizi girin:");

        if (email && password) {
          auth.signInWithEmailAndPassword(email, password)
            .then((userCredential) => {
              showToast("Giriş başarılı!");
            })
            .catch((error) => {
              if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
                // Kullanıcı bulunamazsa veya şifre yanlışsa kayıt olmaya çalış
                auth.createUserWithEmailAndPassword(email, password)
                  .then((userCredential) => {
                    showToast("Kayıt başarılı ve oturum açıldı!");
                  })
                  .catch((registerError) => {
                    showToast("Kayıt olunamadı: " + registerError.message);
                    console.error("Kayıt hatası:", registerError);
                  });
              } else {
                showToast("Giriş yapılamadı: " + error.message);
                console.error("Giriş hatası:", error);
              }
            });
        }
      }, 1000); // 1 saniye basılı tutma süresi
    });

    loginRegisterLink.addEventListener('mouseup', () => {
      clearTimeout(longPressTimer);
    });

    loginRegisterLink.addEventListener('mouseleave', () => {
      clearTimeout(longPressTimer);
    });

    // Toast bildirimi fonksiyonu (diğer sayfalarda da kullanılacak)
    window.showToast = function(message) {
        let toast = document.getElementById('toast');
        if (!toast) {
            toast = document.createElement('div');
            toast.id = 'toast';
            toast.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background-color: #333;
                color: #fff;
                padding: 10px 20px;
                border-radius: 5px;
                opacity: 0;
                transition: opacity 0.5s ease-in-out;
                z-index: 1000;
            `;
            document.body.appendChild(toast);
        }
        toast.textContent = message;
        toast.classList.remove('opacity-0');
        toast.classList.add('opacity-100');
        setTimeout(() => {
            toast.classList.remove('opacity-100');
            toast.classList.add('opacity-0');
        }, 3000); // 3 saniye sonra kaybol
    };

  </script>
</body>
</html>
