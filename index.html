<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Kıbrıs Online</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Montserrat:wght@700&display=swap" rel="stylesheet">
  <style>
    :root {
      --main-blue: #2563eb;
      --main-blue-dark: #1746a2;
      --main-bg: #f6faff;
      --nav-bg: #fff;
      --radius: 18px;
      --shadow: 0 4px 24px #2563eb11;
      --shadow-strong: 0 6px 32px #2563eb22;
      --btn-grad: linear-gradient(90deg, #2563eb, #1746a2 80%);
      --btn-grad-hover: linear-gradient(90deg, #1746a2, #2563eb 80%);
      --input-bg: #f3f7fb;
      --input-border: #c6d7ee;
      --focus: #2563eb44;
      --transition: .18s cubic-bezier(.4,0,.2,1);
    }
    html, body { height:100%; margin:0; padding:0; }
    body {
      min-height: 100vh;
      background: var(--main-bg);
      color: #1b263b;
      font-family: 'Inter', 'Montserrat', Arial, sans-serif;
      letter-spacing: .01em;
      font-size: 17px;
    }
    /* NAVBAR */
    .navbar {
      position: sticky;
      top: 0; left: 0; right: 0;
      z-index: 99;
      background: var(--nav-bg);
      box-shadow: var(--shadow);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 36px;
      height: 68px;
      border-radius: 0 0 18px 18px;
    }
    .nav-brand {
      display: flex;
      align-items: center;
      gap: 15px;
      font-family: 'Montserrat', sans-serif;
      font-size: 2.1rem;
      font-weight: 700;
      color: var(--main-blue);
      letter-spacing: .02em;
      text-shadow: 0 2px 12px #2563eb14;
      user-select: none;
    }
    .nav-buttons {
      display: flex;
      gap: 16px;
      align-items: center;
    }
    .nav-btn {
      padding: 10px 28px;
      border-radius: 12px;
      background: var(--btn-grad);
      color: #fff;
      font-weight: 700;
      border: none;
      font-size: 1.09rem;
      cursor: pointer;
      box-shadow: 0 2px 8px #2563eb19;
      transition: background var(--transition), box-shadow var(--transition), transform var(--transition);
      letter-spacing: .01em;
    }
    .nav-btn:hover, .nav-btn:active {
      background: var(--btn-grad-hover);
      transform: translateY(-2px) scale(1.04);
      box-shadow: 0 6px 28px #2563eb24;
    }
    .nav-user {
      display: flex;
      align-items: center;
      gap: 8px;
      position: relative;
    }
    .nav-avatar {
      width: 42px; height: 42px;
      border-radius: 50%;
      border: 2.5px solid #c6d7ee;
      object-fit: cover;
      background: #e3f0fe;
      box-shadow: 0 1px 8px #2563eb15;
    }
    .nav-username {
      max-width: 170px;
      font-weight: 600;
      color: var(--main-blue-dark);
      font-size: 1.02rem;
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow: hidden;
      font-family: 'Inter', sans-serif;
    }
    .nav-logout {
      background: transparent;
      color: #2563eb;
      border: none;
      font-weight: 700;
      font-size: 1.04rem;
      margin-left: 8px;
      cursor: pointer;
      border-radius: 7px;
      padding: 6px 12px;
      transition: background var(--transition), color var(--transition);
    }
    .nav-logout:hover { background: #e0eaff; color: #1746a2;}
    .nav-login-btn {
      background: var(--btn-grad);
      color: #fff;
      font-weight: 700;
      border: none;
      border-radius: 10px;
      padding: 10px 22px 10px 15px;
      font-size: 1.07rem;
      display: flex;
      align-items: center;
      gap: 7px;
      cursor: pointer;
      box-shadow: 0 2px 6px #2563eb12;
      transition: background var(--transition), box-shadow var(--transition), transform var(--transition);
    }
    .nav-login-btn:hover, .nav-login-btn:active {
      background: var(--btn-grad-hover);
      transform: scale(1.03);
      box-shadow: 0 6px 24px #2563eb28;
    }
    .google-logo { width: 28px; height: 28px; border-radius: 50%; }
    /* Hamburger */
    .hamburger { display: none; flex-direction: column; gap: 5px; cursor: pointer; margin-left: 10px;}
    .hamburger span {
      display: block;
      width: 30px; height: 4px;
      border-radius: 2px;
      background: var(--main-blue);
      transition: all .3s;
    }
    /* Drawer */
    .nav-drawer {
      display: none;
      position: absolute;
      top: 68px; right: 0;
      width: 100vw; max-width: 340px;
      background: #fff;
      box-shadow: var(--shadow-strong);
      border-radius: 0 0 18px 18px;
      z-index: 150;
      padding: 30px 22px 22px 22px;
      flex-direction: column;
      gap: 16px;
      animation: fadeInDrawer .35s;
    }
    @keyframes fadeInDrawer {
      from { opacity: 0; transform: translateY(-30px);}
      to { opacity: 1; transform: translateY(0);}
    }
    .nav-drawer .nav-btn { width: 100%; text-align: left; padding: 13px; margin-bottom: 7px;}
    .nav-drawer .nav-user { margin-top: 14px;}
    /* HERO */
    .hero {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      gap: 60px;
      margin: 0 auto;
      padding: 65px 0 45px 0;
      min-height: 340px;
      max-width: 1100px;
      background: linear-gradient(90deg, #eaf2ff 0, #f6faff 100%);
      border-radius: 0 0 32px 32px;
      box-shadow: 0 3px 24px #2563eb0d;
    }
    .hero-content {
      flex: 1.2;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 15px;
      margin-left: 25px;
    }
    .hero-title {
      font-size: 2.65rem;
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      color: var(--main-blue-dark);
      margin-bottom: 7px;
      letter-spacing: .02em;
      text-shadow: 0 3px 24px #2563eb17;
    }
    .hero-subtitle {
      font-size: 1.25rem;
      color: #25507b;
      font-weight: 500;
      margin-bottom: 20px;
      max-width: 480px;
      line-height: 1.6;
    }
    .hero-img {
      width: 310px;
      max-width: 90vw;
      border-radius: 24px;
      box-shadow: 0 5px 28px #2563eb22;
      object-fit: cover;
      flex: 1;
      background: #fff;
      margin-right: 25px;
      animation: floatY 4s ease-in-out infinite;
    }
    @keyframes floatY {
      0%,100% { transform: translateY(0);}
      50% { transform: translateY(-15px);}
    }
    /* CALC MODULE */
    .module-wrap {
      max-width: 470px;
      margin: 38px auto 18px auto;
      background: #fff;
      border-radius: 22px;
      box-shadow: var(--shadow-strong);
      padding: 36px 26px 28px 26px;
      display: flex;
      flex-direction: column;
      gap: 22px;
      position: relative;
      z-index: 2;
      animation: fadeInUp .7s;
    }
    @keyframes fadeInUp {
      from { opacity:0; transform: translateY(40px);}
      to { opacity:1; transform: translateY(0);}
    }
    .module-title {
      font-size: 1.38rem;
      font-weight: 700;
      color: var(--main-blue);
      text-align: center;
      margin-bottom: 10px;
      letter-spacing: .01em;
    }
    .calc-row {
      display: flex;
      flex-direction: row;
      gap: 14px;
      margin-bottom: 10px;
    }
    .calc-col {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 7px;
    }
    .calc-label {
      font-weight: 600;
      font-size: 1.01rem;
      margin-bottom: 2px;
      color: #1746a2;
      letter-spacing: .01em;
    }
    .calc-input, .calc-select {
      padding: 11px 12px;
      border-radius: 11px;
      border: 1.6px solid var(--input-border);
      font-size: 1.08rem;
      outline: none;
      background: var(--input-bg);
      transition: border .14s, box-shadow .14s;
      min-width: 0;
      box-shadow: 0 1px 4px #2563eb0b;
    }
    .calc-input:focus, .calc-select:focus {
      border: 1.7px solid var(--main-blue);
      background: #fafdff;
      box-shadow: 0 1px 12px var(--focus);
    }
    .calc-action-btn {
      margin-top: 15px;
      width: 100%;
      padding: 16px 0;
      background: var(--btn-grad);
      color: #fff;
      font-size: 1.18rem;
      font-weight: 700;
      border: none;
      border-radius: 11px;
      cursor: pointer;
      transition: background var(--transition), box-shadow var(--transition), transform var(--transition);
      box-shadow: 0 2px 9px #2563eb15;
      letter-spacing: .02em;
    }
    .calc-action-btn:active, .calc-action-btn:hover {
      background: var(--btn-grad-hover);
      transform: scale(1.025);
      box-shadow: 0 8px 32px #2563eb23;
    }
    .calc-result {
      margin-top: 10px;
      padding: 15px 0 2px 0;
      font-size: 1.18rem;
      font-weight: 700;
      color: #1746a2;
      text-align: center;
      min-height: 27px;
      letter-spacing: .01em;
    }
    /* SHOP LOGOS */
    .shop-logos {
      margin: 38px auto 0 auto;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 34px;
      align-items: center;
      max-width: 800px;
      padding-bottom: 35px;
    }
    .shop-logo-link {
      display: flex;
      align-items: center;
      transition: transform .18s;
    }
    .shop-logo-link:hover { transform: scale(1.13) translateY(-2px);}
    .shop-logo {
      height: 44px;
      object-fit: contain;
      filter: grayscale(0.06);
      max-width: 140px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 9px #2563eb0a;
      padding: 7px 10px;
      border: 1px solid #f1f5fa;
      transition: box-shadow .14s;
    }
    @media (max-width:1100px) {
      .hero { flex-direction: column-reverse; gap: 22px; padding:40px 0 25px 0;}
      .hero-content { align-items: center; margin-left:0; text-align: center;}
      .hero-img { margin-right:0;}
    }
    @media (max-width:900px) {
      .navbar { padding: 0 8vw; }
      .module-wrap { max-width: 97vw;}
      .shop-logos { gap: 23px;}
    }
    @media (max-width:670px) {
      .navbar { padding: 0 2vw; height: 60px;}
      .nav-brand { font-size: 1.17rem;}
      .nav-btn { font-size: .96rem; min-width: 90px; padding: 8px 10px;}
      .nav-avatar { width: 29px; height: 29px;}
      .nav-profile-name { font-size: .95rem;}
      .hero-title { font-size: 1.15rem;}
      .hero-img { width: 120px;}
      .module-wrap { padding: 11vw 2vw;}
      .shop-logo { height: 25px; max-width: 70px;}
    }
    @media (max-width:540px) {
      .navbar { flex-wrap: wrap; height: auto; padding: 0 1vw;}
      .nav-buttons { display: none;}
      .hamburger { display: flex;}
      .nav-drawer { display: flex;}
      .module-wrap { padding: 7vw 1.5vw 8vw 1.5vw;}
      .calc-row { flex-direction: column; gap: 0; }
      .shop-logo { height: 16px; max-width: 42px;}
      .module-title { font-size: 1.04rem;}
      .calc-label { font-size: .93rem; }
      .calc-input, .calc-select { font-size: .97rem; padding: 8px 6px;}
      .calc-action-btn { font-size: .99rem; padding: 11px 0;}
    }
  </style>
</head>
<body>
  <!-- NAVBAR -->
  <nav class="navbar">
    <span class="nav-brand">Kıbrıs Online</span>
    <div class="nav-buttons" id="nav-buttons">
      <button class="nav-btn" id="btn-siparis-ver">Sipariş Ver</button>
      <button class="nav-btn" id="btn-siparislerim">Siparişlerim</button>
      <button class="nav-btn" id="btn-kargo-takip">Kargo Takip</button>
    </div>
    <div class="nav-user" id="nav-user">
      <button class="nav-login-btn" id="google-login-btn">
        <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" class="google-logo" alt="Google ile Giriş">
        <span>Google ile Giriş Yap</span>
      </button>
      <span id="profile-box" style="display:none;">
        <img src="" id="profile-img" class="nav-avatar" alt="Profil Fotoğrafı">
        <span class="nav-username" id="profile-name"></span>
        <button class="nav-logout" id="logout-btn">Çıkış Yap</button>
      </span>
    </div>
    <div class="hamburger" id="hamburger" aria-label="Menüyü Aç/Kapat" tabindex="0">
      <span></span><span></span><span></span>
    </div>
    <div class="nav-drawer" id="nav-drawer" style="display:none;">
      <button class="nav-btn" id="drawer-siparis-ver">Sipariş Ver</button>
      <button class="nav-btn" id="drawer-siparislerim">Siparişlerim</button>
      <button class="nav-btn" id="drawer-kargo-takip">Kargo Takip</button>
      <div class="nav-user" id="drawer-user" style="margin-top:14px;">
        <button class="nav-login-btn" id="drawer-google-login-btn">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" class="google-logo" alt="Google ile Giriş">
          <span>Google ile Giriş Yap</span>
        </button>
        <span id="drawer-profile-box" style="display:none;">
          <img src="" id="drawer-profile-img" class="nav-avatar" alt="Profil Fotoğrafı">
          <span class="nav-username" id="drawer-profile-name"></span>
          <button class="nav-logout" id="drawer-logout-btn">Çıkış Yap</button>
        </span>
      </div>
    </div>
  </nav>
  <!-- HERO BANNER -->
  <section class="hero">
    <div class="hero-content">
      <h1 class="hero-title">Türkiye’den Kıbrıs’a Teslimat</h1>
      <div class="hero-subtitle">
        Hızlı ve Güvenilir Kargo Hizmeti<br>
        Siparişlerinizi Türkiye’den Kıbrıs’a kolayca iletin, avantajlı fiyatlarla kapınıza gelsin.
      </div>
    </div>
    <img src="https://cdn.pixabay.com/photo/2016/03/31/20/11/boxes-1299512_1280.png" class="hero-img" alt="Kargo Görseli">
  </section>
  <!-- CALCULATION MODULE -->
  <div class="module-wrap" id="hesaplama-modulu">
    <div class="module-title">Hesaplama Modülü</div>
    <div class="calc-row">
      <div class="calc-col" style="flex:2;">
        <label class="calc-label" for="product-link">Ürün Linki</label>
        <input type="url" id="product-link" class="calc-input" placeholder="Ürün bağlantısını giriniz">
      </div>
    </div>
    <div class="calc-row">
      <div class="calc-col">
        <label class="calc-label" for="product-price">Ürün Fiyatı (₺)</label>
        <input type="number" id="product-price" min="1" step="0.01" class="calc-input" placeholder="Fiyat">
      </div>
      <div class="calc-col">
        <label class="calc-label" for="product-category">Kategori</label>
        <select id="product-category" class="calc-select">
          <option value="">Seçiniz</option>
          <option value="mobilya">Mobilya</option>
          <option value="elektronik">Elektronik</option>
          <option value="giyim">Giyim</option>
          <option value="kirtasiye">Kırtasiye</option>
          <option value="kozmetik">Kozmetik</option>
        </select>
      </div>
    </div>
    <div class="calc-row">
      <div class="calc-col">
        <label class="calc-label" for="delivery-type">Teslimat Tipi</label>
        <select id="delivery-type" class="calc-select">
          <option value="">Seçiniz</option>
          <option value="ev">Eve Teslim</option>
          <option value="depo">Depodan Teslim</option>
        </select>
      </div>
      <div class="calc-col" id="city-group" style="display:none;">
        <label class="calc-label" for="city-select">Şehir</label>
        <select id="city-select" class="calc-select">
          <option value="">Şehir Seçiniz</option>
          <option value="lefkosa">Lefkoşa (200₺)</option>
          <option value="girne">Girne (350₺)</option>
          <option value="magusa">Mağusa (500₺)</option>
          <option value="guzelyurt">Güzelyurt (450₺)</option>
          <option value="lefke">Lefke (600₺)</option>
          <option value="iskele">İskele (550₺)</option>
          <option value="karpaz">Karpaz (700₺)</option>
        </select>
      </div>
    </div>
    <div>
      <button class="calc-action-btn" id="calc-btn">Hesapla</button>
      <div class="calc-result" id="calc-result"></div>
    </div>
  </div>
  <!-- SHOP LOGOS -->
  <div class="shop-logos">
    <a href="https://www.trendyol.com/" class="shop-logo-link" target="_blank" rel="noopener">
      <img src="https://cdn.logo.com/hotlink-ok/logo-social.png?logo=trendyol" alt="Trendyol" class="shop-logo">
    </a>
    <a href="https://www.hepsiburada.com/" class="shop-logo-link" target="_blank" rel="noopener">
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9e/Hepsiburada_logo.svg/512px-Hepsiburada_logo.svg.png" alt="Hepsiburada" class="shop-logo">
    </a>
    <a href="https://www.n11.com/" class="shop-logo-link" target="_blank" rel="noopener">
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/79/N11_logo.svg/512px-N11_logo.svg.png" alt="N11" class="shop-logo">
    </a>
    <a href="https://www.amazon.com.tr/" class="shop-logo-link" target="_blank" rel="noopener">
      <img src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg" alt="Amazon" class="shop-logo">
    </a>
    <a href="https://www.ciceksepeti.com/" class="shop-logo-link" target="_blank" rel="noopener">
      <img src="https://cdn.ciceksepeti.net/assets/images/newdesign/logos/ciceksepeti-logos/ciceksepeti-logo-2022.svg" alt="ÇiçekSepeti" class="shop-logo">
    </a>
  </div>
  <!-- FIREBASE SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-auth-compat.js"></script>
  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCHms5Y5x-KOu3Y43FrfRoljmW_4m3H4yY",
      authDomain: "kibris-6b4f7.firebaseapp.com",
      projectId: "kibris-6b4f7",
      storageBucket: "kibris-6b4f7.firebasestorage.app",
      messagingSenderId: "141262926171",
      appId: "1:141262926171:web:07226845e51d4bbc0dea7e",
      measurementId: "G-JL9P6BRZTD"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // Hamburger menu logic
    const hamburger = document.getElementById('hamburger');
    const navDrawer = document.getElementById('nav-drawer');
    let drawerOpen = false;
    hamburger.onclick = function() {
      drawerOpen = !drawerOpen;
      navDrawer.style.display = drawerOpen ? 'flex' : 'none';
      document.body.style.overflow = drawerOpen ? 'hidden' : '';
    };
    window.addEventListener('resize', () => {
      if (window.innerWidth > 600) {
        navDrawer.style.display = 'none';
        drawerOpen = false;
        document.body.style.overflow = '';
      }
    });
    // Close drawer if clicked outside
    document.addEventListener('mousedown', function(e){
      if(drawerOpen && !navDrawer.contains(e.target) && !hamburger.contains(e.target)){
        navDrawer.style.display = 'none';
        drawerOpen = false;
        document.body.style.overflow = '';
      }
    });

    // Auth UI
    const loginBtn = document.getElementById('google-login-btn');
    const profileBox = document.getElementById('profile-box');
    const profileImg = document.getElementById('profile-img');
    const profileName = document.getElementById('profile-name');
    const logoutBtn = document.getElementById('logout-btn');
    let currentUser = null;
    // Drawer auth UI
    const drawerLoginBtn = document.getElementById('drawer-google-login-btn');
    const drawerProfileBox = document.getElementById('drawer-profile-box');
    const drawerProfileImg = document.getElementById('drawer-profile-img');
    const drawerProfileName = document.getElementById('drawer-profile-name');
    const drawerLogoutBtn = document.getElementById('drawer-logout-btn');

    function showProfile(user) {
      if (!user) return;
      profileImg.src = user.photoURL || "";
      profileName.textContent = user.displayName || "";
      profileBox.style.display = 'inline-flex';
      loginBtn.style.display = 'none';

      drawerProfileImg.src = user.photoURL || "";
      drawerProfileName.textContent = user.displayName || "";
      drawerProfileBox.style.display = 'inline-flex';
      drawerLoginBtn.style.display = 'none';
    }
    function hideProfile() {
      profileBox.style.display = 'none';
      loginBtn.style.display = 'flex';
      drawerProfileBox.style.display = 'none';
      drawerLoginBtn.style.display = 'flex';
    }
    loginBtn.onclick = drawerLoginBtn.onclick = function() {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider)
        .catch(err => {
          alert("Giriş başarısız: " + (err.message || err));
        });
    };
    logoutBtn.onclick = drawerLogoutBtn.onclick = function() {
      auth.signOut();
    };

    auth.onAuthStateChanged(function(user){
      currentUser = user;
      if(user){
        showProfile(user);
      }else{
        hideProfile();
      }
    });

    // NAV BAR BUTTONS & DRAWER BUTTONS
    function requireLogin(actionFn) {
      if (!currentUser) {
        alert("Lütfen giriş yapınız");
        return false;
      }
      if (typeof actionFn === "function") actionFn();
      return true;
    }
    document.getElementById('btn-siparis-ver').onclick =
    document.getElementById('drawer-siparis-ver').onclick = function() {
      requireLogin(() => {
        window.location.href = "siparisver.html";
      });
    };
    document.getElementById('btn-siparislerim').onclick =
    document.getElementById('drawer-siparislerim').onclick = function() {
      requireLogin(() => {
        window.location.href = "siparislerim.html";
      });
    };
    document.getElementById('btn-kargo-takip').onclick =
    document.getElementById('drawer-kargo-takip').onclick = function() {
      requireLogin(() => {
        window.location.href = "kargotakip.html";
      });
    };

    // CALCULATION MODULE
    const categoryMultipliers = {
      mobilya: 1.7,
      elektronik: 1.7,
      giyim: 1.45,
      kirtasiye: 1.4,
      kozmetik: 1.7
    };
    const cityFees = {
      lefkosa: 200,
      girne: 350,
      magusa: 500,
      guzelyurt: 450,
      lefke: 600,
      iskele: 550,
      karpaz: 700
    };

    const deliveryType = document.getElementById('delivery-type');
    const cityGroup = document.getElementById('city-group');
    const citySelect = document.getElementById('city-select');
    const calcBtn = document.getElementById('calc-btn');
    const calcResult = document.getElementById('calc-result');
    let calcState = "hesapla"; // or "siparisver"
    let lastCalculation = null;

    deliveryType.addEventListener('change', function() {
      if (deliveryType.value === "ev") {
        cityGroup.style.display = "flex";
      } else {
        citySelect.value = "";
        cityGroup.style.display = "none";
      }
    });

    function formatMoney(val) {
      return Number(val).toLocaleString("tr-TR", {minimumFractionDigits:2, maximumFractionDigits:2}) + " ₺";
    }

    calcBtn.addEventListener('click', function() {
      if (calcState === "hesapla") {
        // Get values
        const price = parseFloat(document.getElementById('product-price').value);
        const category = document.getElementById('product-category').value;
        const delivery = deliveryType.value;
        let city = citySelect.value;
        calcResult.textContent = "";

        // Validate
        if (isNaN(price) || price < 1) {
          calcResult.textContent = "Lütfen geçerli ürün fiyatı giriniz.";
          return;
        }
        if (!category || !categoryMultipliers[category]) {
          calcResult.textContent = "Lütfen kategori seçiniz.";
          return;
        }
        if (!delivery) {
          calcResult.textContent = "Lütfen teslimat tipi seçiniz.";
          return;
        }
        if (delivery === "ev" && (!city || !cityFees[city])) {
          calcResult.textContent = "Lütfen şehir seçiniz.";
          return;
        }
        // Calculation
        let total = price * categoryMultipliers[category];
        if (delivery === "ev") {
          total += cityFees[city];
        }
        lastCalculation = total;
        calcResult.textContent = "Toplam Tutar: " + formatMoney(total);
        calcBtn.textContent = "Sipariş Ver";
        calcState = "siparisver";
      } else {
        // Sipariş Ver
        if (!currentUser) {
          alert("Lütfen giriş yapınız");
          return;
        }
        window.location.href = "siparisver.html";
      }
    });

    // Reset button if any input changes
    [
      'product-link','product-price','product-category','delivery-type','city-select'
    ].forEach(function(id){
      document.getElementById(id).addEventListener('input', function(){
        calcBtn.textContent = "Hesapla";
        calcState = "hesapla";
        calcResult.textContent = "";
      });
    });
  </script>
</body>
</html>
