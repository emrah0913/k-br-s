<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getir Kıbrıs</title>
<script src="https://cdn.tailwindcss.com/3.4.16"></script>
<script>tailwind.config={theme:{extend:{colors:{primary:'#5d3ebc',secondary:'#ffd300'},borderRadius:{'none':'0px','sm':'4px',DEFAULT:'8px','md':'12px','lg':'16px','xl':'20px','2xl':'24px','3xl':'32px','full':'9999px','button':'8px'}}}}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
<!-- Firebase SDK (Compat) -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<style>
:where([class^="ri-"])::before { content: "\f3c2"; }
body {
font-family: 'Inter', sans-serif;
background-color: #f9f9f9;
}
.copy-btn:active {
transform: scale(0.95);
}
</style>
</head>
<body class="bg-gray-50">
<div class="w-[375px] mx-auto relative min-h-screen pb-16">
<!-- Header -->
<header class="fixed top-0 w-full bg-white shadow-sm z-50 px-4 py-3 flex justify-between items-center">
<div class="w-8"></div>
<div class="flex flex-col items-center">
<img src="https://static.readdy.ai/image/d4cf8783f5bb2724d5eb1b66ee82374b/8de9178d5e8d147b21dbfa093538290a.png" alt="Getir Kıbrıs" class="h-12">
<a href="https://getirkibris.com/siparisverv1" data-readdy="true" class="text-primary font-medium text-sm mt-1">Sipariş Ver</a>
</div>
<div id="auth-button" class="w-8 h-8 flex items-center justify-center">
<button id="login-btn" class="text-xs text-primary font-medium cursor-pointer">
<i class="ri-google-fill ri-lg"></i>
</button>
<div id="profile-container" class="hidden">
<img id="profile-img" src="" alt="Profil" class="w-8 h-8 rounded-full cursor-pointer">
</div>
</div>
</header>
<!-- Main Content -->
<main class="pt-24 pb-20">
<!-- Main Action Buttons -->
<div class="grid grid-cols-2 gap-4 px-4 mb-8">
<a href="https://getirkibris.com/indexv1" data-readdy="true" id="calculate-btn" class="bg-white shadow-md p-4 rounded-button flex flex-col items-center justify-center h-36 cursor-pointer border border-gray-100 hover:border-primary/20 transition-all">
<div class="w-14 h-14 bg-primary/10 rounded-full flex items-center justify-center mb-3">
<i class="ri-calculator-line ri-2x text-primary"></i>
</div>
<span class="text-base font-medium">Hesapla</span>
</a>
<a href="https://getirkibris.com/indexv1" data-readdy="true" id="order-btn" class="bg-white shadow-md p-4 rounded-button flex flex-col items-center justify-center h-36 cursor-pointer border border-gray-100 hover:border-primary/20 transition-all">
<div class="w-14 h-14 bg-primary/10 rounded-full flex items-center justify-center mb-3">
<i class="ri-home-line ri-2x text-primary"></i>
</div>
<span class="text-base font-medium">Ana Sayfa</span>
</a>
<a href="https://getirkibris.com/siparislerimv1" class="bg-white shadow-md p-4 rounded-button flex flex-col items-center justify-center h-36 cursor-pointer border border-gray-100 hover:border-primary/20 transition-all">
<div class="w-14 h-14 bg-primary/10 rounded-full flex items-center justify-center mb-3">
<i class="ri-file-list-3-line ri-2x text-primary"></i>
</div>
<span class="text-base font-medium">Siparişlerim</span>
</a>
<a href="https://getirkibris.com/kargotakipv1" data-readdy="true" id="track-btn" class="bg-white shadow-md p-4 rounded-button flex flex-col items-center justify-center h-36 cursor-pointer border border-gray-100 hover:border-primary/20 transition-all">
<div class="w-14 h-14 bg-primary/10 rounded-full flex items-center justify-center mb-3">
<i class="ri-truck-line ri-2x text-primary"></i>
</div>
<span class="text-base font-medium">Kargo Takip</span>
</a>
</div>
<!-- Calculator Section -->
<div id="calculator-section" class="bg-white rounded-lg shadow-md mx-4 p-4 mb-8">
<h3 class="text-lg font-semibold mb-4 text-primary">Sipariş Modülü</h3>
<form id="calculator-form" class="space-y-4">
<div>
<label for="order-method" class="block text-sm font-medium text-gray-700 mb-1">Sipariş Yöntemi</label>
<div class="relative mb-4">
<i class="ri-shopping-bag-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
<select id="order-method" class="w-full pl-10 pr-10 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary appearance-none bg-white text-sm">
<option value="" disabled selected>Sipariş yöntemi seçin</option>
<option value="self">Ürünü ben sipariş edeceğim, sadece kargo hizmeti istiyorum</option>
<option value="service">Ürünü benim yerime siz sipariş edin, size ödeme yapacağım</option>
</select>
<i class="ri-arrow-down-s-line ri-lg absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"></i>
</div>
<div id="order-code-input" class="hidden">
<label for="order-code" class="block text-sm font-medium text-gray-700 mb-1">Sipariş Kodu</label>
<div class="relative">
<i class="ri-barcode-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
<input type="text" id="order-code" name="order-code" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary" placeholder="Sipariş kodunuzu girin">
</div>
</div>
<div class="space-y-4 mb-4">
<div>
<label for="full-name" class="block text-sm font-medium text-gray-700 mb-1">Ad Soyad</label>
<div class="relative">
<i class="ri-user-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
<input type="text" id="full-name" name="full-name" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary" placeholder="Ad Soyad">
</div>
</div>
<div>
<label for="phone" class="block text-sm font-medium text-gray-700 mb-1">Telefon Numarası</label>
<div class="relative">
<i class="ri-phone-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
<input type="tel" id="phone" name="phone" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary" placeholder="0533 123 4567">
</div>
</div>
</div>
<div>
<label for="product-link" class="block text-sm font-medium text-gray-700 mb-1">Ürün Linki</label>
<div class="relative">
<i class="ri-link ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
<input type="url" id="product-link" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary" placeholder="https://www.example.com/urun">
</div>
</div>
</div>
<div>
<label for="product-price" class="block text-sm font-medium text-gray-700 mb-1">Ürün Fiyatı (₺)</label>
<div class="relative">
<i class="ri-money-lira-circle-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
<input type="number" id="product-price" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary" placeholder="0.00">
</div>
</div>
<div>
<label for="product-category" class="block text-sm font-medium text-gray-700 mb-1">Kategori</label>
<div class="relative">
<i class="ri-price-tag-3-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
<select id="product-category" class="w-full pl-10 pr-10 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary appearance-none bg-white text-sm">
<option value="" disabled selected>Kategori seçin</option>
<option value="furniture">Mobilya</option>
<option value="electronics">Elektronik</option>
<option value="clothing">Giyim</option>
<option value="cosmetics">Kozmetik</option>
<option value="stationery">Kırtasiye</option>
</select>
<i class="ri-arrow-down-s-line ri-lg absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"></i>
</div>
</div>
<div>
<span class="block text-sm font-medium text-gray-700 mb-2">Teslimat Tipi</span>
<div class="flex space-x-4">
<label class="flex items-center cursor-pointer">
<input type="radio" name="delivery-type" value="warehouse" class="sr-only" checked>
<div class="w-5 h-5 border border-gray-300 rounded-full flex items-center justify-center mr-2 delivery-radio cursor-pointer">
<div class="w-3 h-3 bg-primary rounded-full hidden"></div>
</div>
<span class="text-sm">Depodan teslim</span>
</label>
<label class="flex items-center cursor-pointer">
<input type="radio" name="delivery-type" value="home" class="sr-only">
<div class="w-5 h-5 border border-gray-300 rounded-full flex items-center justify-center mr-2 delivery-radio cursor-pointer">
<div class="w-3 h-3 bg-primary rounded-full hidden"></div>
</div>
<span class="text-sm">Eve teslim</span>
</label>
</div>
</div>
<div id="city-selection" class="hidden">
<label for="city" class="block text-sm font-medium text-gray-700 mb-1">Şehir</label>
<div class="relative">
<i class="ri-building-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
<select id="city" name="city" class="w-full pl-10 pr-10 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary appearance-none bg-white text-sm">
<option value="" disabled selected>Şehir seçin</option>
<option value="lefkosa">Lefkoşa</option>
<option value="girne">Girne</option>
<option value="magusa">Gazimağusa</option>
<option value="guzelyurt">Güzelyurt</option>
<option value="iskele">İskele</option>
</select>
<i class="ri-arrow-down-s-line ri-lg absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"></i>
</div>
<div id="delivery-address-input" class="hidden mt-4">
<label for="delivery-address" class="block text-sm font-medium text-gray-700 mb-1">Teslimat Adresi</label>
<div class="relative">
<i class="ri-map-pin-line ri-lg absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
<input type="text" id="delivery-address" name="delivery-address" class="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-button focus:outline-none focus:border-primary" placeholder="Teslimat adresinizi girin">
</div>
</div>
</div>
<!-- Buton JS ile eklenecek -->
</form>
<!-- Onay mesajı için alan JS ile eklenecek -->
<div id="calculation-result" class="mt-6 p-4 bg-gray-50 rounded-lg hidden">
<h4 class="font-medium text-gray-800 mb-2">Hesaplama Sonucu</h4>
<div class="space-y-2 text-sm">
<div class="flex justify-between">
<span>Ürün Fiyatı:</span>
<span id="result-price">0 ₺</span>
</div>
<div class="flex justify-between">
<span>Kategori Ücreti:</span>
<span id="result-category-fee">0 ₺</span>
</div>
<div class="flex justify-between" id="result-city-row">
<span>Teslimat Ücreti:</span>
<span id="result-delivery-fee">0 ₺</span>
</div>
<div class="flex justify-between font-medium text-primary pt-2 border-t border-gray-200">
<span>Toplam:</span>
<span id="result-total">0 ₺</span>
</div>
</div>
</div>
</div>
<!-- ... diğer içerik aynı ... -->
<!-- Firebase ve diğer scriptler ... -->
<script id="calculator-script">
document.addEventListener('DOMContentLoaded', function() {
const calculatorForm = document.getElementById('calculator-form');
const citySelection = document.getElementById('city-selection');
const deliveryRadios = document.querySelectorAll('input[name="delivery-type"]');
const calculationResult = document.getElementById('calculation-result');
const resultCityRow = document.getElementById('result-city-row');
const orderMethod = document.getElementById('order-method');
const orderCodeInput = document.getElementById('order-code-input');
const citySelect = document.getElementById('city');
const deliveryAddressInput = document.getElementById('delivery-address-input');

// Onay mesajı elementi ekle
let approvalMsg = document.createElement("div");
approvalMsg.id = "order-approval-message";
approvalMsg.className = "hidden mt-4 text-center";
calculatorForm.parentElement.insertBefore(approvalMsg, calculatorForm.nextSibling);

let calculationState = "calculate";
let lastOrderData = null;

citySelect.addEventListener('change', function() {
    if (this.value) {
        deliveryAddressInput.classList.remove('hidden');
    } else {
        deliveryAddressInput.classList.add('hidden');
    }
});
orderMethod.addEventListener('change', function() {
    if (this.value === 'self') {
        orderCodeInput.classList.remove('hidden');
    } else {
        orderCodeInput.classList.add('hidden');
    }
});
function handleDeliveryTypeChange(radio) {
    document.querySelectorAll('.delivery-radio div').forEach(dot => {
        dot.classList.add('hidden');
    });
    radio.parentElement.querySelector('.delivery-radio div').classList.remove('hidden');
    if (radio.value === 'home') {
        citySelection.classList.remove('hidden');
    } else {
        citySelection.classList.add('hidden');
    }
}
deliveryRadios.forEach(radio => {
    radio.addEventListener('change', function() {
        handleDeliveryTypeChange(this);
    });
    const customRadio = radio.parentElement.querySelector('.delivery-radio');
    customRadio.addEventListener('click', function() {
        radio.checked = true;
        handleDeliveryTypeChange(radio);
    });
});
const defaultRadio = document.querySelector('input[name="delivery-type"]:checked');
if (defaultRadio) {
    handleDeliveryTypeChange(defaultRadio);
}

// Sipariş butonunu ekle
const calculateOrOrderBtn = document.createElement('button');
calculateOrOrderBtn.type = "button";
calculateOrOrderBtn.id = "calculate-or-order-btn";
calculateOrOrderBtn.className = "w-full bg-primary text-white py-3 rounded-button font-medium hover:bg-primary/90 transition-colors cursor-pointer !rounded-button";
calculateOrOrderBtn.textContent = "Hesapla";
const oldSubmitBtn = calculatorForm.querySelector('button[type="submit"]');
if (oldSubmitBtn) {
    oldSubmitBtn.parentNode.replaceChild(calculateOrOrderBtn, oldSubmitBtn);
}

calculateOrOrderBtn.addEventListener('click', function() {
    // Onay mesajını gizle
    approvalMsg.classList.add("hidden");
    approvalMsg.innerHTML = "";

    if (calculationState === "calculate") {
        const orderMethodVal = document.getElementById('order-method').value;
        const fullName = document.getElementById('full-name').value;
        const phone = document.getElementById('phone').value;
        const price = parseFloat(document.getElementById('product-price').value) || 0;
        const orderCode = document.getElementById('order-code') ? document.getElementById('order-code').value : '';
        const productLink = document.getElementById('product-link').value;
        const category = document.getElementById('product-category').value;
        const deliveryType = document.querySelector('input[name="delivery-type"]:checked').value;
        const city = document.getElementById('city') ? document.getElementById('city').value : '';
        const deliveryAddress = document.getElementById('delivery-address') ? document.getElementById('delivery-address').value : '';
        if (!fullName.trim()) { showToast('Lütfen ad soyad girin'); return; }
        if (orderMethodVal === 'self' && !orderCode.trim()) { showToast('Lütfen sipariş kodunu girin'); return; }
        if (!phone.trim()) { showToast('Lütfen telefon numarası girin'); return; }
        const phoneRegex = /^[0-9\s]{10,15}$/;
        if (!phoneRegex.test(phone.replace(/\D/g, ''))) { showToast('Lütfen geçerli bir telefon numarası girin'); return; }
        if (!orderMethodVal) { showToast('Lütfen sipariş yöntemi seçin'); return; }
        if (price <= 0) { showToast('Lütfen geçerli bir fiyat girin'); return; }
        if (!category) { showToast('Lütfen bir kategori seçin'); return; }
        const categoryRates = {
            'furniture': 0.70,
            'electronics': 0.70,
            'clothing': 0.45,
            'cosmetics': 0.70,
            'stationery': 0.40
        };
        const categoryFee = price * categoryRates[category];
        let deliveryFee = 0;
        if (deliveryType === 'home') {
            deliveryFee = 200;
        }
        const total = price + categoryFee + deliveryFee;
        document.getElementById('result-price').textContent = `${price.toFixed(2)} ₺`;
        document.getElementById('result-category-fee').textContent = `${categoryFee.toFixed(2)} ₺`;
        document.getElementById('result-delivery-fee').textContent = `${deliveryFee.toFixed(2)} ₺`;
        document.getElementById('result-total').textContent = `${total.toFixed(2)} ₺`;
        if (deliveryType === 'home') {
            resultCityRow.classList.remove('hidden');
        } else {
            resultCityRow.classList.add('hidden');
        }
        calculationResult.classList.remove('hidden');
        calculationResult.scrollIntoView({ behavior: 'smooth' });

        lastOrderData = {
            fullName,
            phone,
            productLink,
            productPrice: price,
            orderMethod: orderMethodVal,
            orderCode: orderMethodVal === 'self' ? orderCode : '',
            category,
            categoryFee,
            deliveryType,
            city: deliveryType === 'home' ? city : '',
            deliveryAddress: deliveryType === 'home' ? deliveryAddress : '',
            deliveryFee,
            total,
            createdAt: new Date(),
            user: firebase.auth().currentUser ? firebase.auth().currentUser.uid : null
        };
        calculateOrOrderBtn.textContent = "Siparişi Onayla";
        calculationState = "order";
    } else {
        // Siparişi kaydet
        if (!lastOrderData) return;
        if (typeof firebase !== "undefined" && firebase.firestore && lastOrderData.user) {
            db.collection('orders').add(lastOrderData).then(() => {
                // Onay mesajı göster
                approvalMsg.innerHTML = '<div class="bg-green-100 border border-green-300 text-green-800 font-semibold rounded-lg px-4 py-3 inline-block">✔️ Siparişiniz onaylandı!</div>';
                approvalMsg.classList.remove("hidden");
                // Formu ve state'i sıfırla
                calculatorForm.reset();
                calculationResult.classList.add('hidden');
                calculateOrOrderBtn.textContent = "Hesapla";
                calculationState = "calculate";
            }).catch(err => {
                showToast("Sipariş kaydedilemedi: " + (err.message || "Bilinmeyen hata"));
            });
        } else {
            showToast("Giriş yapmadan sipariş veremezsiniz.");
        }
    }
});
calculatorForm.addEventListener('submit', function(e) { e.preventDefault(); });
});
</script>
<!-- ... diğer scriptler aynı ... -->
</body>
</html>
