<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TÃ¼rkiye'den KÄ±brÄ±s'a SipariÅŸ Getirme Hizmeti | Getir KÄ±brÄ±s</title>
    <meta name="description" content="Trendyol, Hepsiburada ve diÄŸer TÃ¼rkiye sitelerinden KÄ±brÄ±s'a kolayca Ã¼rÃ¼n getirin. Ã‡oklu eÅŸya hesaplayÄ±n ve sepetinize ekleyin.">
    <link rel="icon" href="/favicon.ico?v=2" type="image/x-icon">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5d3ebc',
                        secondary: '#ffd300',
                        accent: '#2ecc71',
                        dark: '#1a1a1a'
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                    borderRadius: {
                        'button': '8px',
                        DEFAULT: '24px',
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f9f9f9; -webkit-tap-highlight-color: transparent; }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .hidden { display: none; }
        .tab-active { background-color: #5d3ebc; color: white; font-weight: 800; box-shadow: 0 10px 15px -3px rgba(93, 62, 188, 0.3); }
        .tab-inactive { color: #6b7280; font-weight: 600; background-color: #f3f4f6; }
        
        /* ÃœrÃ¼n Slider YapÄ±sÄ± */
        .product-slider { 
            display: flex;
            overflow-x: auto; 
            scroll-snap-type: x mandatory;
            scrollbar-width: none; 
            -ms-overflow-style: none; 
            white-space: nowrap; 
            scroll-behavior: smooth; 
            -webkit-overflow-scrolling: touch; 
            padding-bottom: 1rem;
        }
        .product-slider::-webkit-scrollbar { display: none; }
        .product-card {
            display: inline-block;
            width: 280px;
            margin-right: 1.5rem;
            white-space: normal;
            scroll-snap-align: start;
        }
        
        .hero-banner { background: linear-gradient(135deg, #5d3ebc 0%, #4c2fb3 100%); }
    </style>
</head>
<body class="bg-gray-50">

<div class="w-full max-w-screen-lg mx-auto relative min-h-screen pb-16">

    <!-- Header -->
    <header class="fixed top-0 w-full max-w-screen-lg bg-white/95 backdrop-blur-md shadow-sm z-50 px-4 py-3 flex items-center justify-between">
        <div class="flex items-center gap-2 logo-container">
            <img src="logom.png" alt="Getir KÄ±brÄ±s" class="h-10" onerror="this.src='https://placehold.co/140x45/5d3ebc/ffffff?text=Getir+Kibris'">
            <div class="h-6 w-px bg-gray-200 mx-2 hidden sm:block"></div>
            <a href="index.html" class="text-xs font-black text-primary uppercase tracking-tighter">Ana Sayfa</a>
        </div>
        <div id="auth-button" class="flex items-center gap-3">
            <button id="login-btn" class="text-primary font-black px-4 py-2 border-2 border-primary rounded-xl text-[11px] hover:bg-primary hover:text-white transition-all uppercase">
                <i class="ri-google-fill mr-1"></i> GiriÅŸ Yap
            </button>
            <div id="profile-container" class="hidden">
                <img id="profile-img" src="" alt="Profil" class="w-10 h-10 rounded-full border-2 border-primary cursor-pointer shadow-md inline-block">
            </div>
        </div>
    </header>

    <main class="pt-24 px-4">
        
        <!-- Hero Section -->
        <section class="hero-banner rounded-[40px] p-8 mb-10 text-white relative overflow-hidden shadow-2xl">
            <div class="relative z-10 max-w-2xl font-inter">
                <div class="inline-flex items-center gap-2 bg-secondary text-primary px-3 py-1 rounded-full text-[10px] font-black uppercase mb-4 shadow-lg">
                    <i class="ri-shield-flash-fill"></i> Lojistik Operasyon Merkezi
                </div>
                <h1 class="text-3xl sm:text-4xl font-black mb-4 leading-tight tracking-tight">TÃ¼rkiye'den KÄ±brÄ±s'a SipariÅŸ Vermek ArtÄ±k Ã‡ok Kolay</h1>
                <p class="text-indigo-50 mb-6 text-sm opacity-95 font-medium leading-relaxed">
                    Trendyol, Amazon ve tÃ¼m sitelerden alÄ±ÅŸveriÅŸinizi yapÄ±n, biz kapÄ±nÄ±za getirelim. Mobilya, elektronik veya tekstil fark etmez, tek sepette yÃ¶netin.
                </p>
            </div>
            <i class="ri-archive-stack-line absolute -bottom-10 -right-10 text-white/5 text-[280px] rotate-6 pointer-events-none"></i>
        </section>

        <!-- HÄ±zlÄ± Aksiyonlar -->
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-12 text-center">
            <a href="https://getirkibris.com/getirhome" class="bg-gradient-to-br from-secondary to-secondary/80 shadow-lg p-6 rounded-3xl flex flex-col items-center justify-center border border-secondary/50 hover:scale-[1.03] transition-all group overflow-hidden relative">
                <div class="w-14 h-14 bg-white rounded-full flex items-center justify-center mb-3 shadow-xl border-2 border-white p-1.5 transition-transform group-hover:rotate-6">
                    <img src="getir-home-logo.png" alt="Getir Home" class="w-full h-full object-contain" onerror="this.src='https://placehold.co/80x80/ffd300/5d3ebc?text=Home'">
                </div>
                <span class="text-xs font-black text-primary uppercase tracking-wider">Getir Home</span>
            </a>

            <button id="action-calculate-btn" class="bg-white shadow-xl shadow-gray-200/50 p-6 rounded-3xl flex flex-col items-center justify-center border border-gray-100 hover:border-primary/40 hover:scale-[1.03] transition-all group">
                <div class="w-14 h-14 bg-primary/10 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                    <i class="ri-flashlight-fill ri-2x text-primary"></i>
                </div>
                <span class="text-xs font-black text-gray-800 uppercase tracking-tight">SipariÅŸ Ver / Hesapla</span>
            </button>

            <a href="sepet.html" class="bg-white shadow-xl shadow-gray-200/50 p-6 rounded-3xl flex flex-col items-center justify-center border border-gray-100 hover:border-primary/40 hover:scale-[1.03] transition-all group relative">
                <div class="w-14 h-14 bg-primary/10 rounded-full flex items-center justify-center mb-3 group-hover:scale-110 transition-transform">
                    <i class="ri-shopping-bag-3-fill ri-2x text-primary"></i>
                    <span id="cart-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-[10px] font-black rounded-full h-6 w-6 flex items-center justify-center hidden border-2 border-white shadow-lg">0</span>
                </div>
                <span class="text-xs font-black text-gray-800 uppercase tracking-tight">SipariÅŸlerim</span>
            </a>
        </div>

        <!-- AkÄ±llÄ± Hesaplama ModÃ¼lÃ¼ -->
        <section id="calculator-section" class="bg-white rounded-[40px] shadow-2xl mx-auto p-8 mb-16 max-w-2xl border border-gray-100 relative overflow-hidden hidden fade-in">
            <div class="absolute top-0 left-0 w-2 h-full bg-primary"></div>
            <div class="mb-8">
                <h2 class="text-2xl font-black text-gray-800 tracking-tight">AkÄ±llÄ± HesaplayÄ±cÄ±</h2>
                <p class="text-xs text-gray-400 font-bold uppercase mt-1 text-primary tracking-widest text-center">GÃ¼mrÃ¼k, Nakliye ve Sigorta Dahil</p>
            </div>

            <form id="calculator-form" class="space-y-6">
                <!-- SipariÅŸ YÃ¶ntemi -->
                <div>
                    <label for="order-method" class="block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2">SipariÅŸ YÃ¶ntemi</label>
                    <select id="order-method" class="w-full p-4 bg-gray-50 border-2 border-transparent focus:border-primary/20 rounded-2xl outline-none text-sm font-semibold transition-all">
                        <option value="service" selected>ÃœrÃ¼nÃ¼ benim yerime siz sipariÅŸ edin</option>
                        <option value="self">ÃœrÃ¼nÃ¼ ben alacaÄŸÄ±m, sadece kargo hizmeti istiyorum</option>
                    </select>
                </div>

                <!-- ÃœrÃ¼n Linki -->
                <div class="relative group">
                    <i class="ri-link-m absolute left-5 top-1/2 -translate-y-1/2 text-gray-400"></i>
                    <input type="url" id="product-link" required class="w-full p-5 pl-14 bg-gray-50 border-2 border-transparent focus:border-primary/10 rounded-3xl outline-none text-sm font-semibold" placeholder="ÃœrÃ¼n linkini yapÄ±ÅŸtÄ±rÄ±n...">
                </div>

                <!-- ÃœrÃ¼n FiyatÄ± -->
                <div class="relative group">
                    <i class="ri-money-dollar-circle-line absolute left-5 top-1/2 -translate-y-1/2 text-gray-400"></i>
                    <input type="number" id="product-price" required class="w-full p-5 pl-14 bg-gray-50 border-2 border-transparent focus:border-primary/10 rounded-3xl outline-none text-sm font-semibold" placeholder="ÃœrÃ¼n FiyatÄ± (â‚º)" step="0.01">
                </div>

                <!-- Kategori -->
                <div>
                    <label class="block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2">SipariÅŸ Kategorisi</label>
                    <select id="product-category" required class="w-full p-5 bg-gray-50 border-2 border-transparent focus:border-primary/10 rounded-3xl outline-none text-sm font-semibold transition-all">
                        <option value="" disabled selected>Kategori SeÃ§in</option>
                    </select>
                </div>

                <!-- SonuÃ§ Paneli -->
                <div id="calculation-result" class="mt-8 p-8 bg-dark text-white rounded-[32px] hidden shadow-2xl relative overflow-hidden border-2 border-primary/20">
                    <div class="relative z-10 space-y-4">
                        <div id="row-items-price" class="flex justify-between items-center text-xs text-gray-400 font-bold uppercase tracking-wider">
                            <span id="result-price-label">ÃœrÃ¼n Bedeli</span>
                            <span id="result-price" class="text-white font-black">0 â‚º</span>
                        </div>
                        <div class="flex justify-between items-center text-xs text-gray-400 font-bold uppercase tracking-wider">
                            <span>Lojistik & GÃ¼mrÃ¼k</span>
                            <span id="result-category-fee" class="text-accent font-black">+0 â‚º</span>
                        </div>
                        <div class="pt-5 border-t border-white/10 flex justify-between items-center">
                            <span class="text-[10px] font-black uppercase tracking-[3px] text-primary bg-white px-3 py-1 rounded-full">Net Toplam</span>
                            <span id="result-total" class="text-3xl font-black text-secondary">0 â‚º</span>
                        </div>
                    </div>
                </div>

                <button type="submit" id="main-action-btn" class="w-full bg-primary text-white py-6 rounded-[24px] font-black uppercase tracking-[4px] hover:bg-primary/95 transition-all shadow-2xl shadow-primary/30">
                    <span id="main-btn-text">Maliyeti Hesapla</span>
                </button>
            </form>
        </section>

        <!-- Kampanya Vitrini -->
        <h2 class="text-2xl font-black text-gray-800 mb-6 text-center border-b-4 border-primary inline-block pb-2 tracking-tighter uppercase">ðŸ›’ PopÃ¼ler FÄ±rsatlar</h2>
        <div class="product-slider px-2 mb-16">
            <!-- ÃœrÃ¼n 1 -->
            <div class="product-card bg-white shadow-xl rounded-3xl overflow-hidden border border-gray-100 flex-shrink-0">
                <img src="https://cdn.dsmcdn.com/ty1339/product/media/images/prod/QC/20240531/13/4f260764-0e89-3345-85d3-c78b2860a122/1_org_zoom.jpg" class="w-full h-48 object-contain p-4" loading="lazy">
                <div class="p-5 text-center">
                    <h3 class="text-xs font-black text-gray-800 mb-2 truncate uppercase">Legom Aktivite KoltuÄŸu</h3>
                    <p class="text-lg font-black text-red-600 mb-4">12.635,00 â‚º</p>
                    <a href="https://www.trendyol.com/good-night/legom-aktivite-koltugu-yatak-cok-amacli-p-833506385" target="_blank" class="block w-full text-center bg-primary text-white text-[10px] font-black py-3 rounded-xl uppercase">SatÄ±n Al</a>
                </div>
            </div>
            <!-- ÃœrÃ¼n 2 -->
            <div class="product-card bg-white shadow-xl rounded-3xl overflow-hidden border border-gray-100 flex-shrink-0">
                <img src="https://cdn.dsmcdn.com/ty1583/prod/QC/20241008/22/36a5c729-891b-369b-9235-de1c4459aab2/1_org_zoom.jpg" class="w-full h-48 object-contain p-4" loading="lazy">
                <div class="p-5 text-center">
                    <h3 class="text-xs font-black text-gray-800 mb-2 truncate uppercase">3'lÃ¼ KÄ±ÅŸlÄ±k Ev TerliÄŸi</h3>
                    <p class="text-lg font-black text-red-600 mb-4">289,90 â‚º</p>
                    <a href="https://www.trendyol.com/star-shoes/3-lu-kislik-ev-terligi-kislik-terlik-misafir-terligi-p-864790548" target="_blank" class="block w-full text-center bg-primary text-white text-[10px] font-black py-3 rounded-xl uppercase">SatÄ±n Al</a>
                </div>
            </div>
            <!-- ÃœrÃ¼n 3 -->
            <div class="product-card bg-white shadow-xl rounded-3xl overflow-hidden border border-gray-100 flex-shrink-0">
                <img src="https://cdn.dsmcdn.com/ty1613/prod/QC/20241208/02/3f26a3f7-9329-3fbf-976d-40355be6ec72/1_org_zoom.jpg" class="w-full h-48 object-contain p-4" loading="lazy">
                <div class="p-5 text-center">
                    <h3 class="text-xs font-black text-gray-800 mb-2 truncate uppercase">Oversize ÅžiÅŸme Mont</h3>
                    <p class="text-lg font-black text-red-600 mb-4">826,68 â‚º</p>
                    <a href="https://www.trendyol.com/lia-blanco-s/kadin-siyah-oversize-sisme-kislik-mont-dik-yaka-p-856865482" target="_blank" class="block w-full text-center bg-primary text-white text-[10px] font-black py-3 rounded-xl uppercase">SatÄ±n Al</a>
                </div>
            </div>
            <!-- ÃœrÃ¼n 4 -->
            <div class="product-card bg-white shadow-xl rounded-3xl overflow-hidden border border-gray-100 flex-shrink-0">
                <img src="https://cdn.dsmcdn.com/ty1521/product/media/images/prod/QC/20240903/19/2055f782-17d7-358f-bf14-480a25545b92/1_org_zoom.jpg" class="w-full h-48 object-contain p-4" loading="lazy">
                <div class="p-5 text-center">
                    <h3 class="text-xs font-black text-gray-800 mb-2 truncate uppercase">Ovex SaÃ§ Terapisi</h3>
                    <p class="text-lg font-black text-red-600 mb-4">379,24 â‚º</p>
                    <a href="https://www.trendyol.com/hc-care/ovex-hizli-sac-kurtarma-ve-canlandirma-terapisi-200-ml-p-7103580" target="_blank" class="block w-full text-center bg-primary text-white text-[10px] font-black py-3 rounded-xl uppercase">SatÄ±n Al</a>
                </div>
            </div>
        </div>

        <!-- AlÄ±ÅŸveriÅŸ Siteleri Grid -->
        <div class="px-2 mb-16">
            <h3 class="text-lg font-black mb-8 uppercase tracking-widest text-gray-300 text-center sm:text-left">MaÄŸazalar</h3>
            <div class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-5">
                <a href="https://www.trendyol.com" target="_blank" class="bg-white rounded-3xl shadow-sm p-4 h-28 flex items-center justify-center border border-gray-50 hover:shadow-md transition-all">
                    <img src="https://www.freelogovectors.net/wp-content/uploads/2024/01/trendyol_logo-freelogovectors.net_.png" class="max-h-12 object-contain grayscale hover:grayscale-0 transition-all">
                </a>
                <a href="https://www.hepsiburada.com" target="_blank" class="bg-white rounded-3xl shadow-sm p-4 h-28 flex items-center justify-center border border-gray-50 hover:shadow-md transition-all">
                    <img src="https://www.ideasoft.com.tr/wp-content/uploads/2022/05/Hepsiburada-Logo-Transparan.png" class="max-h-12 object-contain grayscale hover:grayscale-0 transition-all">
                </a>
                <a href="https://www.n11.com" target="_blank" class="bg-white rounded-3xl shadow-sm p-4 h-28 flex items-center justify-center border border-gray-50 hover:shadow-md transition-all">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/6/60/N11_logo.svg" class="max-h-12 object-contain grayscale hover:grayscale-0 transition-all">
                </a>
                <a href="https://www.amazon.com.tr" target="_blank" class="bg-white rounded-3xl shadow-sm p-4 h-28 flex items-center justify-center border border-gray-50 hover:shadow-md transition-all">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTZvIiXt3ogobFi7dC0k1dMgpNvrwiTQl6cbA&s" class="max-h-12 object-contain grayscale hover:grayscale-0 transition-all">
                </a>
                <a href="https://www.zara.com.tr" target="_blank" class="bg-white rounded-3xl shadow-sm p-4 h-28 flex items-center justify-center border border-gray-50 hover:shadow-md transition-all">
                    <img src="https://logodownload.org/wp-content/uploads/2014/05/zara-logo-0.png" class="max-h-12 object-contain grayscale hover:grayscale-0 transition-all">
                </a>
                <a href="https://www.temu.com" target="_blank" class="bg-white rounded-3xl shadow-sm p-4 h-28 flex items-center justify-center border border-gray-50 hover:shadow-md transition-all">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/Temu_logo_icon.svg/2048px-Temu_logo_icon.svg.png" class="max-h-10 object-contain grayscale hover:grayscale-0 transition-all">
                </a>
            </div>
        </div>

        <!-- TanÄ±tÄ±m Videosu (Ä°stediÄŸiniz Konumda) -->
        <div class="mb-16">
            <h3 class="text-xl font-black mb-6 text-gray-800 uppercase tracking-tighter text-center">NasÄ±l Ã‡alÄ±ÅŸÄ±yoruz?</h3>
            <div class="relative w-full overflow-hidden rounded-[40px] shadow-2xl bg-black border-4 border-white" style="padding-top: 56.25%;">
                <iframe class="absolute top-0 left-0 w-full h-full" src="https://www.youtube.com/embed/YYNLzJJKTXs" title="TanÄ±tÄ±m Videosu" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
            </div>
        </div>

        <!-- Bilgi BÃ¶lÃ¼mÃ¼ -->
        <div class="bg-white p-8 rounded-[40px] shadow-sm border border-gray-100 mb-16">
            <h3 class="text-xl font-black mb-6 text-primary tracking-tighter flex items-center gap-2">
                <i class="ri-map-pin-user-fill"></i> Depo & Ä°letiÅŸim Bilgileri
            </h3>
            <div class="grid sm:grid-cols-2 gap-8">
                <div class="bg-gray-50 p-6 rounded-3xl border border-gray-100">
                    <h4 class="font-black text-[10px] uppercase mb-4 text-primary tracking-widest">TÃ¼rkiye Kabul Deposu (Adres)</h4>
                    <p class="text-[11px] text-gray-600 leading-relaxed font-medium">
                        <strong>Adres:</strong> Bozyurt Mah. Kanal ÃœstÃ¼ 3281 sk. No:3, Nazilli/AydÄ±n<br>
                        <strong>Telefon:</strong> +90 547 190 19 88<br>
                        <strong>Yetkili:</strong> Emrah Kutlu
                    </p>
                </div>
                <div class="bg-gray-50 p-6 rounded-3xl border border-gray-100">
                    <h4 class="font-black text-[10px] uppercase mb-4 text-primary tracking-widest">KÄ±brÄ±s Teslim Deposu (LefkoÅŸa)</h4>
                    <p class="text-[11px] text-gray-600 leading-relaxed font-medium">
                        <strong>Adres:</strong> AlaykÃ¶y Sanayi BÃ¶lgesi 1.Etap, 8.Sokak, LefkoÅŸa<br>
                        <strong>Telefon:</strong> +90 533 860 71 82<br>
                        <strong>E-posta:</strong> info@getirkibris.com
                    </p>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="mt-20 px-4 pb-16 text-center text-[10px] text-gray-400 font-bold uppercase tracking-widest border-t pt-10">
        <div class="flex justify-center gap-6 mb-8">
            <a href="gizlilik-politikasi.html" class="hover:text-primary transition-colors">Gizlilik</a>
            <a href="kullanim-sartlari.html" class="hover:text-primary transition-colors">Åžartlar</a>
            <a href="sss.html" class="hover:text-primary transition-colors">S.S.S.</a>
        </div>
        <p>&copy; 2024 Getir KÄ±brÄ±s. TÃ¼m HaklarÄ± SaklÄ±dÄ±r.</p>
    </footer>

    <!-- WhatsApp Sabit Buton -->
    <a href="https://wa.me/905471901988" target="_blank" class="fixed bottom-10 right-10 bg-[#25D366] w-16 h-16 rounded-full shadow-2xl flex items-center justify-center text-white text-4xl z-50 hover:scale-110 transition-transform">
        <i class="ri-whatsapp-line"></i>
    </a>

    <!-- Toast Bildirim -->
    <div id="toast" class="fixed bottom-32 left-1/2 -translate-x-1/2 bg-dark text-white px-8 py-4 rounded-full text-[10px] font-black uppercase tracking-widest opacity-0 transition-all z-[200] shadow-2xl pointer-events-none border border-white/10"></div>

    <!-- Login Modal -->
    <div id="login-modal" class="fixed inset-0 bg-dark/80 hidden items-center justify-center z-[100] p-4 backdrop-blur-md">
        <div class="bg-white w-full max-w-sm rounded-[40px] p-10 text-center shadow-2xl">
            <h3 class="text-xl font-black mb-4 uppercase tracking-tighter text-gray-800">HoÅŸ Geldiniz</h3>
            <p class="text-xs text-gray-500 mb-8 font-medium">SipariÅŸ vermek ve takibini yapmak iÃ§in Google ile giriÅŸ yapÄ±n.</p>
            <button id="google-login-btn" class="w-full py-4 bg-gray-100 hover:bg-gray-200 rounded-2xl font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-colors">
                <i class="ri-google-fill text-red-500"></i> Google Ä°le GiriÅŸ
            </button>
            <button onclick="document.getElementById('login-modal').classList.add('hidden')" class="mt-4 text-[10px] font-black text-gray-400 hover:text-gray-600 transition-colors uppercase tracking-widest">KAPAT</button>
        </div>
    </div>

</div>

<script type="module">
    // Firebase v9 Modular SDK ImportlarÄ± (Sizin koddaki gibi)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
    import { getFirestore, doc, getDoc, collection, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    // Firebase YapÄ±landÄ±rmasÄ± (Sizin koddaki config deÄŸerleri)
    const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
        apiKey: "AIzaSyCHms5Y5x-KOu3Y43FrfRoljmW_4m3H4yY",
        authDomain: "kibris-6b4f7.firebaseapp.com",
        projectId: "kibris-6b4f7",
        storageBucket: "kibris-6b4f7.firebasestorage.app",
        messagingSenderId: "141262926171",
        appId: "1:141262926171:web:07226845e51d4bbc0dea7e"
    };
    const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
    
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // BaÅŸlangÄ±Ã§ Yetkilendirmesi (Rule 3)
    const initAuth = async () => {
        try {
            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                await signInWithCustomToken(auth, __initial_auth_token);
            } else {
                await signInAnonymously(auth).catch(() => console.log("Anonim giriÅŸ pasif."));
            }
        } catch (error) {
            console.error("Yetkilendirme hatasÄ±:", error);
        }
    };
    initAuth();
    
    let calculationState = 'idle'; 
    let pricingSettings = {
        categoryRates: { 'furniture': 0.75, 'shopping': 0.45, 'personal': 0.35, 'electronics': 0.85, 'hobby': 0.55, 'industrial': 0.90 }
    };

    // DOM Elements
    const loginBtn = document.getElementById('login-btn');
    const googleLoginBtn = document.getElementById('google-login-btn');
    const profileCont = document.getElementById('profile-container');
    const profileImg = document.getElementById('profile-img');
    const cartBadge = document.getElementById('cart-badge');
    const calcSection = document.getElementById('calculator-section');
    const calcForm = document.getElementById('calculator-form');
    const mainActionBtn = document.getElementById('main-action-btn');
    const mainBtnText = document.getElementById('main-btn-text');
    const calcResultPanel = document.getElementById('calculation-result');
    const toast = document.getElementById('toast');

    function init() {
        // Auth Listener
        onAuthStateChanged(auth, user => {
            if(user && !user.isAnonymous) {
                loginBtn.classList.add('hidden');
                profileCont.classList.remove('hidden');
                profileImg.src = user.photoURL || 'https://placehold.co/40x40?text=U';
                listenToCart(user.uid); // Sepet dinleyiciyi baÅŸlat
            } else {
                loginBtn.classList.remove('hidden');
                profileCont.classList.add('hidden');
            }
            loadPricingSettings(); 
        });

        // Event Listeners
        if (loginBtn) loginBtn.onclick = () => document.getElementById('login-modal').classList.remove('hidden');
        if (googleLoginBtn) googleLoginBtn.onclick = async () => {
            try {
                await signInWithPopup(auth, new GoogleAuthProvider());
                document.getElementById('login-modal').classList.add('hidden');
                showToast("GiriÅŸ yapÄ±ldÄ±.");
            } catch (e) { showToast("GiriÅŸ baÅŸarÄ±sÄ±z."); }
        };

        const triggerBtn = document.getElementById('action-calculate-btn');
        if (triggerBtn) triggerBtn.onclick = () => { 
            calcSection.classList.remove('hidden'); 
            calcSection.scrollIntoView({ behavior: 'smooth' }); 
        };

        if (calcForm) {
            calcForm.onsubmit = (e) => {
                e.preventDefault();
                if(calculationState === 'idle') calculate();
                else addToCart();
            };
        }
    }

    function calculate() {
        const price = parseFloat(document.getElementById('product-price').value) || 0;
        const cat = document.getElementById('product-category').value;
        const method = document.getElementById('order-method').value;

        if(!cat || price <= 0) { showToast("LÃ¼tfen fiyat ve kategori girin."); return; }

        const fee = price * (pricingSettings.categoryRates[cat] || 0.45);
        const total = method === 'self' ? fee : price + fee;

        document.getElementById('result-price-label').textContent = method === 'self' ? 'ÃœrÃ¼n Bedeli (Size Ait)' : 'ÃœrÃ¼n Bedeli';
        document.getElementById('result-price').textContent = `${price.toLocaleString('tr-TR')} â‚º`;
        document.getElementById('result-category-fee').textContent = `+${fee.toLocaleString('tr-TR')} â‚º`;
        document.getElementById('result-total').textContent = `${total.toLocaleString('tr-TR', {minimumFractionDigits: 2})} â‚º`;
        
        calcResultPanel.classList.remove('hidden');
        mainActionBtn.classList.replace('bg-primary', 'bg-accent');
        mainBtnText.innerText = 'Sepete Ekle';
        calculationState = 'calculated';
        showToast("Maliyet hesaplandÄ±.");
    }

    async function addToCart() {
        const user = auth.currentUser;
        if(!user || user.isAnonymous) { 
            document.getElementById('login-modal').classList.remove('hidden'); 
            return; 
        }

        const totalStr = document.getElementById('result-total').textContent;
        const cleanTotal = Number(totalStr.replace('â‚º','').replace(/\./g,'').replace(',','.').trim());

        try {
            showToast("Ekleniyor...");
            // Canvas Path Rule: /artifacts/{appId}/users/{userId}/cart
            await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'cart'), {
                productLink: document.getElementById('product-link').value,
                price: parseFloat(document.getElementById('product-price').value),
                category: document.getElementById('product-category').value,
                method: document.getElementById('order-method').value,
                total: cleanTotal,
                addedAt: new Date(),
                status: 'pending'
            });
            showToast("Sepete eklendi.");
            resetCalculator();
        } catch (e) {
            console.error(e);
            showToast("Hata: Sepete eklenemedi.");
        }
    }

    function listenToCart(uid) {
        // Canvas Path Rule: /artifacts/{appId}/users/{userId}/cart
        onSnapshot(collection(db, 'artifacts', appId, 'users', uid, 'cart'), (snap) => {
            const count = snap.size;
            cartBadge.textContent = count;
            cartBadge.classList.toggle('hidden', count === 0);
        }, (err) => console.log("Sepet dinleme hatasÄ±."));
    }

    async function loadPricingSettings() {
        // Canvas Path Rule: /artifacts/{appId}/public/data/settings/pricing
        try {
            const snap = await getDoc(doc(db, 'artifacts', appId, 'public', 'data', 'settings', 'pricing'));
            if (snap.exists()) pricingSettings = snap.data();
        } catch (e) { console.log("Ayarlar yÃ¼klenemedi, varsayÄ±lanlar kullanÄ±lÄ±yor."); }
        populateCategories();
    }

    function populateCategories() {
        const sel = document.getElementById('product-category');
        const names = { shopping: "Giyim & Tekstil", furniture: "Mobilya & BÃ¼yÃ¼k EÅŸya", personal: "Paket & Kargo", electronics: "Elektronik & KÃ¼Ã§Ã¼k Ev", hobby: "Spor & Hobi", industrial: "Sanayi & DiÄŸer" };
        sel.innerHTML = '<option value="" disabled selected>Kategori SeÃ§in</option>' + 
            Object.keys(pricingSettings.categoryRates).map(k => `<option value="${k}">${names[k] || k}</option>`).join('');
    }

    function resetCalculator() {
        calculationState = 'idle';
        calcForm.reset();
        calcResultPanel.classList.add('hidden');
        mainActionBtn.classList.replace('bg-accent', 'bg-primary');
        mainBtnText.innerText = 'Maliyeti Hesapla';
    }

    function showToast(msg) {
        toast.innerText = msg;
        toast.classList.replace('opacity-0', 'opacity-100');
        setTimeout(() => toast.classList.replace('opacity-100', 'opacity-0'), 3000);
    }

    init();
</script>

</body>
</html>
