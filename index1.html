<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T√ºrkiye'den Kƒ±brƒ±s'a Sipari≈ü Getirme Hizmeti | Getir Kƒ±brƒ±s</title>

    <meta name="description" content="Trendyol, Hepsiburada ve diƒüer T√ºrkiye sitelerinden Kƒ±brƒ±s'a kolayca √ºr√ºn getirin. Hesaplayƒ±n ve sepetinize ekleyin.">
    <link rel="canonical" href="https://getirkibris.com" />
    <link rel="icon" href="/favicon.ico?v=2" type="image/x-icon">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#5d3ebc',
                        secondary: '#ffd300'
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                    borderRadius: {
                        'button': '8px',
                        'none': '0px',
                        'sm': '4px',
                        DEFAULT: '8px',
                        'md': '12px',
                        'lg': '16px',
                        'xl': '20px',
                        '2xl': '24px',
                        '3xl': '32px',
                        'full': '9999px',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f9f9f9;
        }
        .copy-btn:active, .auth-button:active {
            transform: scale(0.95);
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .hidden {
            display: none;
        }
        .product-slider {
            overflow-x: auto; 
            scrollbar-width: none;
            -ms-overflow-style: none;
            white-space: nowrap;
            padding-bottom: 1rem;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch; 
        }
        .product-slider::-webkit-scrollbar {
            display: none;
        }
        .product-card {
            display: inline-block;
            width: 300px;
            margin-right: 1.5rem;
            white-space: normal;
            scroll-snap-align: start; 
        }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    </style>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-JL9P6BRZTD"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-JL9P6BRZTD');
</script>

</head>
<body class="bg-gray-50">

<div class="w-full max-w-screen-lg mx-auto relative min-h-screen pb-16">

    <header class="fixed top-0 w-full bg-white shadow-sm z-50 px-4 py-3 flex items-center">
        <div class="flex-1"></div>
        <div class="flex flex-col items-center">
            <img src="logom.png" alt="Getir Kƒ±brƒ±s" class="h-12"> 
            <a href="https://getirkibris.com/index.html" class="text-sm font-medium text-primary mt-1">Ana Sayfa</a>
        </div>
        <div class="flex-1 flex justify-end">
            <div id="auth-button" class="w-8 h-8 flex items-center justify-center">
                <button id="login-btn" class="text-xs text-primary font-medium cursor-pointer">
                    <i class="ri-google-fill ri-lg"></i>
                </button>
                <div id="profile-container" class="hidden">
                    <img id="profile-img" src="" alt="Profil" class="w-8 h-8 rounded-full cursor-pointer">
                </div>
            </div>
        </div>
    </header>

<div class="px-4 pt-28 mb-6">
    <div class="relative overflow-hidden rounded-2xl p-7 text-white shadow-xl border-b-4 border-[#ffd300]" 
         style="background: radial-gradient(circle at center, #6b46e5 0%, #4a329d 100%);">
        
        <div class="mb-6">
            <h2 class="text-2xl font-black tracking-tight leading-none uppercase">
                ≈ûeffaf Fiyatlandƒ±rma <br>
                <span class="text-[#ffd300] text-lg font-bold italic opacity-90">S√ºrpriz Maliyetlere Son</span>
            </h2>
        </div>
        
        <div class="grid grid-cols-1 gap-4">
            <div class="bg-white/10 backdrop-blur-md p-5 rounded-xl border border-white/10">
                <div class="flex items-center gap-4">
                    <div class="bg-white/20 w-12 h-12 rounded-lg flex items-center justify-center border border-white/30">
                        <i class="ri-box-3-line text-[#ffd300] text-2xl"></i>
                    </div>
                    <div>
                        <p class="text-[11px] uppercase tracking-widest opacity-70 font-bold">Hizmet Kapsamƒ±</p>
                        <p class="text-lg font-extrabold text-white">G√ºmr√ºk + Kargo + Nakliye</p>
                    </div>
                </div>
                <div class="mt-3 pt-3 border-t border-white/10 text-[#ffd300] font-bold text-sm flex items-center gap-2">
                    <i class="ri-checkbox-circle-fill"></i>
                    T√úM S√úRE√á TEK Fƒ∞YATA DAHƒ∞LDƒ∞R
                </div>
            </div>

            <div class="grid grid-cols-1 gap-3 px-1 text-white">
                <div class="flex items-center gap-3 text-sm opacity-90 font-medium">
                    <i class="ri-arrow-right-s-line text-[#ffd300]"></i>
                    <span>Ekstra g√ºmr√ºk vergisi talep edilmez.</span>
                </div>
                <div class="flex items-center gap-3 text-sm opacity-90 font-medium">
                    <i class="ri-arrow-right-s-line text-[#ffd300]"></i>
                    <span>Hesaplanan tutar net teslimat fiyatƒ±dƒ±r.</span>
                </div>
                <div class="flex items-center gap-3 text-sm opacity-90 font-medium">
                    <i class="ri-arrow-right-s-line text-[#ffd300]"></i>
                    <span>T√ºm operasyonel s√ºre√ßler tarafƒ±mƒ±zca y√∂netilir.</span>
                </div>
            </div>
        </div>

        <div class="mt-6 flex items-center justify-center gap-2 text-[10px] font-bold uppercase tracking-widest opacity-60 border-t border-white/5 pt-4">
            <i class="ri-shield-check-line text-lg text-white"></i>
            <span class="text-white">Uluslararasƒ± Ta≈üƒ±ma Standartlarƒ±</span>
        </div>
    </div>
</div>

<div class="grid grid-cols-1 gap-4 px-4 mb-8">
    <a href="getirhome.html"
        class="bg-[#ffd300] shadow-md p-4 rounded-button flex flex-col items-center justify-center h-32 cursor-pointer border border-[#ffd300] hover:bg-[#ffdf00] transition-all">
        <div class="w-20 h-20 bg-white rounded-full flex items-center justify-center mb-1 shadow-sm overflow-hidden p-1">
            <img src="getirhome-logo.png" alt="GetirHome" class="w-full h-full object-contain">
        </div>
        <span class="text-sm font-bold text-gray-900">GetirHome</span>
    </a>

    <button id="calculate-btn"
        class="bg-white shadow-md p-4 rounded-button flex flex-col items-center justify-center h-32 cursor-pointer border border-gray-100 hover:border-primary/20 transition-all">
        <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2">
            <i class="ri-calculator-line ri-xl text-primary"></i>
        </div>
        <span class="text-sm font-medium">Sipari≈ü Ver</span>
    </button>

    <a href="https://getirkibris.com/sepet.html" id="cart-page-btn"
        class="relative bg-white shadow-md p-4 rounded-button flex flex-col items-center justify-center h-32 cursor-pointer border border-gray-100 hover:border-primary/20 transition-all">
        <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-2">
            <i class="ri-shopping-cart-line ri-xl text-primary"></i>
        </div>
        <span class="text-sm font-medium">Sepetim</span>
        <span id="cart-badge" class="absolute bg-red-500 text-white text-xs font-bold rounded-full h-4 w-4 flex items-center justify-center hidden" style="top: 10px; right: 10px;">0</span>
    </a>
</div>

        <section id="calculator-section" class="bg-white rounded-lg shadow-lg mx-auto p-6 mb-8 max-w-2xl fade-in hidden notranslate">
            <h2 class="text-xl font-semibold mb-4 text-primary">1. √úr√ºn Bilgilerini Girin</h2>
            <form id="calculator-form" class="space-y-4">
                <div>
                    <label for="order-method" class="block text-sm font-medium text-gray-700 mb-1">Sipari≈ü Y√∂ntemi<span class="text-red-500">*</span></label>
                    <select id="order-method" required class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50 text-sm">
                        <option value="service" selected>√úr√ºn√º benim yerime siz sipari≈ü edin</option>
                        <option value="self">√úr√ºn√º ben alacaƒüƒ±m, sadece kargo hizmeti istiyorum</option>
                    </select>
                </div>
                <div>
                    <label for="product-link" class="block text-sm font-medium text-gray-700 mb-1">√úr√ºn Linki<span class="text-red-500">*</span></label>
                    <input type="url" id="product-link" required class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50" placeholder="https://www.example.com/urun">
                </div>
                <div>
                    <label for="product-price" class="block text-sm font-medium text-gray-700 mb-1">√úr√ºn Fiyatƒ± (‚Ç∫)<span class="text-red-500">*</span></label>
                    <input type="number" id="product-price" required class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50" placeholder="150.00" step="any" min="0.01">
                </div>
                <div>
                    <label for="product-category" class="block text-sm font-medium text-gray-700 mb-1">Kategori<span class="text-red-500">*</span></label>
                    <select id="product-category" required class="w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50 text-sm">
                        <option value="" disabled selected>Kategoriler Y√ºkleniyor...</option>
                    </select>
                </div>
                
                <div id="calculation-result" class="mt-6 p-4 bg-gray-50 rounded-lg hidden notranslate">
                    <h3 class="font-medium text-gray-800 mb-2">√úr√ºn Getirme Maliyeti</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span id="result-price-label">√úr√ºn Fiyatƒ±:</span>
                            <span id="result-price">0 ‚Ç∫</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Kategori Hizmet Bedeli:</span>
                            <span id="result-category-fee">0 ‚Ç∫</span>
                        </div>
                        <div class="flex justify-between font-bold text-primary pt-2 border-t border-gray-200">
                            <span>Getirme Dahil Toplam:</span>
                            <span id="result-total">0 ‚Ç∫</span>
                        </div>
                    </div>
                </div>

                <button type="submit" id="main-action-btn" class="w-full bg-primary text-white py-3 rounded-button font-semibold hover:bg-primary/90 transition-colors cursor-pointer flex items-center justify-center gap-2">
                    <i class="ri-calculator-line"></i>
                    <span>Maliyeti Hesapla</span>
                </button>
            </form>
        </section>

<h2 class="text-2xl font-extrabold text-gray-800 mb-4 px-4 border-l-4 border-primary ml-4">
    üõí Pop√ºler √úr√ºnler
</h2>

<div class="product-slider flex overflow-x-auto gap-4 p-4 snap-x snap-mandatory scrollbar-hide">

    <div class="product-card relative flex-shrink-0 w-[280px] shadow-lg hover:shadow-xl transition-all duration-300 rounded-2xl overflow-hidden border border-gray-100 bg-white snap-start">
        <div class="absolute top-3 left-3 z-10">
            <span class="bg-green-500 text-white text-[9px] font-bold px-2 py-1 rounded-md shadow-sm flex items-center gap-1">
                <i class="ri-truck-fill"></i> √úCRETSƒ∞Z KARGO
            </span>
        </div>
        <div class="h-48 bg-gray-50 flex items-center justify-center p-4">
            <img src="https://omhucph.com/cdn/shop/files/Sommer2025_omhu4754_POSO_40_sRGB_Low.png?v=1761298437&width=1900" alt="Legom Koltuk" class="max-h-full object-contain mix-blend-multiply" loading="lazy">
        </div>
        <div class="p-4 text-center">
            <h3 class="text-sm font-bold text-gray-800 truncate">Legom Koltuk</h3>
            <p class="text-[10px] text-gray-500 uppercase tracking-tighter mb-2">Getir Home'dan G√∂nderim</p>
            <div class="mb-3">
                <p class="text-lg font-black text-red-600 leading-none">19.000,00 ‚Ç∫</p>
                <p class="text-[9px] font-bold text-primary mt-1 uppercase tracking-widest bg-primary/5 py-1 rounded-full">
                    <i class="ri-checkbox-circle-fill"></i> G√ºmr√ºk + Kargo Dahil
                </p>
            </div>
            <a href="https://getirkibris.com/getirhome?category=Legom+Koltuk" class="block w-full bg-primary text-white text-sm font-bold py-2 rounded-lg hover:bg-primary/90 transition-colors">Satƒ±n Al</a>
        </div>
    </div>

    <div class="product-card relative flex-shrink-0 w-[280px] shadow-lg hover:shadow-xl transition-all duration-300 rounded-2xl overflow-hidden border border-gray-100 bg-white snap-start">
        <div class="absolute top-3 left-3 z-10">
            <span class="bg-green-500 text-white text-[9px] font-bold px-2 py-1 rounded-md shadow-sm flex items-center gap-1">
                <i class="ri-truck-fill"></i> √úCRETSƒ∞Z KARGO
            </span>
        </div>
        <div class="h-48 bg-gray-50 flex items-center justify-center p-4">
            <img src="https://omhucph.com/cdn/shop/files/Omhu126018_W_CREAM_WHITE_-_5769_1.png?v=1761578226&width=1536" alt="Legom XL Koltuk" class="max-h-full object-contain mix-blend-multiply" loading="lazy">
        </div>
        <div class="p-4 text-center">
            <h3 class="text-sm font-bold text-gray-800 truncate">Legom XL Koltuk</h3>
            <p class="text-[10px] text-gray-500 uppercase tracking-tighter mb-2">Getir Home'dan G√∂nderim</p>
            <div class="mb-3">
                <p class="text-lg font-black text-red-600 leading-none">32.000,00 ‚Ç∫</p>
                <p class="text-[9px] font-bold text-primary mt-1 uppercase tracking-widest bg-primary/5 py-1 rounded-full">
                    <i class="ri-checkbox-circle-fill"></i> G√ºmr√ºk + Kargo Dahil
                </p>
            </div>
            <a href="https://getirkibris.com/getirhome?view=detail&id=4EB3NPv3gcV20oDbgH1S" class="block w-full bg-primary text-white text-sm font-bold py-2 rounded-lg hover:bg-primary/90 transition-colors">Satƒ±n Al</a>
        </div>
    </div>

</div>

<div class="px-4 mb-8">
    <h3 class="text-lg font-semibold mb-4">Pop√ºler Alƒ±≈üveri≈ü Siteleri</h3>
    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4">
        <a href="https://www.trendyol.com" target="_blank" class="bg-white rounded-lg shadow-sm p-3 h-20 flex items-center justify-center cursor-pointer border border-gray-100">
            <img src="https://www.freelogovectors.net/wp-content/uploads/2024/01/trendyol_logo-freelogovectors.net_.png" alt="Trendyol" class="w-16 h-16 object-contain">
        </a>
        <a href="https://www.hepsiburada.com" target="_blank" class="bg-white rounded-lg shadow-sm p-3 h-20 flex items-center justify-center cursor-pointer border border-gray-100">
            <img src="https://www.ideasoft.com.tr/wp-content/uploads/2022/05/Hepsiburada-Logo-Transparan.png" alt="Hepsiburada" class="w-16 h-16 object-contain">
        </a>
        <a href="https://www.n11.com" target="_blank" class="bg-white rounded-lg shadow-sm p-3 h-20 flex items-center justify-center cursor-pointer border border-gray-100">
            <img src="https://upload.wikimedia.org/wikipedia/commons/6/60/N11_logo.svg" alt="N11" class="w-16 h-16 object-contain">
        </a>
        <a href="https://www.amazon.com.tr" target="_blank" class="bg-white rounded-lg shadow-sm p-3 h-20 flex items-center justify-center cursor-pointer border border-gray-100">
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTZvIiXt3ogobFi7dC0k1dMgpNvrwiTQl6cbA&s" alt="Amazon" class="w-16 h-16 object-contain">
        </a>
    </div>
</div>

<div class="mt-8 bg-gray-50 p-6 rounded-xl shadow-sm mx-4">
  <h3 class="text-xl font-semibold mb-3 text-gray-800">Sipari≈ü Y√∂ntemleri</h3>
  <div class="space-y-6">
    <div class="bg-white p-4 rounded-lg shadow">
      <h4 class="font-semibold text-lg text-indigo-700 mb-2">1Ô∏è‚É£ √úr√ºn√º Benim Yerime Sipari≈ü Edin</h4>
      <p class="text-gray-700 text-sm">√úr√ºn√º sizin yerinize biz sipari≈ü ediyoruz. √ñdemeyi bize yapƒ±yorsunuz, t√ºm s√ºreci biz takip ediyoruz.</p>
    </div>
    <div class="bg-white p-4 rounded-lg shadow">
      <h4 class="font-semibold text-lg text-indigo-700 mb-2">2Ô∏è‚É£ √úr√ºn√º Ben Alacaƒüƒ±m Sadece Kargo Hizmeti ƒ∞stiyorum</h4>
      <div class="bg-gray-100 p-3 rounded-lg mt-3 text-xs">
        <p class="font-semibold">Getir Kƒ±brƒ±s T√ºrkiye Adresi:</p>
        <p>Aydƒ±n, Nazilli, Bozyurt Mah. Kanal √úst√º 3281 sk. No:3 / Telefon: +90 547 190 19 88 / Ad Soyad: Emrah Kutlu</p>
      </div>
    </div>
  </div>
</div>

<div class="mt-8 px-4 pb-20 text-center">
    <div class="space-x-4">
        <a href="gizlilik-politikasi.html" class="text-xs text-gray-600 hover:text-primary">Gizlilik Politikasƒ±</a>
        <a href="kullanim-sartlari.html" class="text-xs text-gray-600 hover:text-primary">Kullanƒ±m ≈ûartlarƒ±</a>
        <a href="sss.html" class="text-xs text-gray-600 hover:text-primary">S.S.S.</a>
    </div>
</div>

<a href="https://wa.me/905471901988" target="_blank" class="fixed bottom-20 right-4 z-50 bg-[#25D366] rounded-full shadow-lg flex items-center justify-center hover:bg-[#20bd5a] transition-colors p-6">
   <i class="ri-whatsapp-line ri-xl text-white"></i>
</a>

<div id="login-modal" class="fixed inset-0 bg-black/60 flex items-center justify-center z-[100] hidden">
    <div class="bg-white rounded-lg p-8 w-full max-w-sm m-4 relative fade-in">
        <button id="close-login-modal" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="ri-close-line ri-lg"></i></button>
        <div class="text-center mb-6">
            <h3 class="text-2xl font-bold text-gray-800">Ho≈ü Geldiniz!</h3>
            <p class="text-sm text-gray-600 mt-1">Giri≈ü yapƒ±n.</p>
        </div>
        <button id="google-login-btn" class="w-full flex items-center justify-center gap-3 border border-gray-300 rounded-button py-3 font-semibold text-gray-700 hover:bg-gray-50 transition-colors">
            <i class="ri-google-fill ri-lg text-red-500"></i>
            <span>Google ile Giri≈ü Yap</span>
        </button>
    </div>
</div>

<div id="profile-modal" class="fixed inset-0 bg-black/60 flex items-center justify-center z-[100] hidden">
    <div class="bg-white rounded-lg p-8 w-full max-w-sm m-4 relative fade-in">
        <h3 class="text-2xl font-bold text-gray-800 text-center mb-2">Profilinizi Tamamlayƒ±n</h3>
        <form id="profile-form" class="space-y-4">
            <div><label class="block text-sm font-medium">Ad Soyad*</label><input type="text" id="full-name-input" required class="w-full p-2 border rounded-md"></div>
            <div><label class="block text-sm font-medium">Telefon*</label><input type="tel" id="phone-input" required class="w-full p-2 border rounded-md"></div>
            <div><label class="block text-sm font-medium">Adres*</label><textarea id="address-input" required rows="3" class="w-full p-2 border rounded-md"></textarea></div>
            <button type="submit" class="w-full bg-primary text-white py-3 rounded-button">Profili Kaydet</button>
        </form>
    </div>
</div>

<div id="auth-required-modal" class="fixed inset-0 bg-black/60 flex items-center justify-center z-[100] hidden">
    <div class="bg-white rounded-lg p-8 w-full max-w-sm m-4 text-center fade-in">
        <i class="ri-lock-line ri-2x text-red-500"></i>
        <h3 class="text-xl font-bold">Giri≈ü Gerekli</h3>
        <button id="auth-modal-login-btn" class="w-full bg-primary text-white py-2 mt-4 rounded-button">Giri≈ü Yap</button>
        <button id="close-auth-modal" class="mt-2 text-gray-500">Kapat</button>
    </div>
</div>

<div id="toast" class="fixed bottom-24 right-6 bg-gray-800 text-white px-5 py-3 rounded-lg shadow-xl opacity-0 transition-all duration-300 z-[110] transform translate-y-4">
    <span id="toast-message"></span>
</div>

</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc, collection, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCHms5Y5x-KOu3Y43FrfRoljmW_4m3H4yY",
        authDomain: "kibris-6b4f7.firebaseapp.com",
        projectId: "kibris-6b4f7",
        storageBucket: "kibris-6b4f7.firebasestorage.app",
        messagingSenderId: "141262926171",
        appId: "1:141262926171:web:07226845e51d4bbc0dea7e",
        measurementId: "G-JL9P6BRZTD"
    };
    
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    let cartUnsubscribe = null;
    let pricingSettings = {};
    const DEFAULT_SETTINGS = {
        categoryRates: { 'furniture': 0.70, 'clothing': 0.45, 'cosmetics': 0.70, 'stationery': 0.40 }
    };

    const loginBtn = document.getElementById('login-btn');
    const profileContainer = document.getElementById('profile-container');
    const profileImg = document.getElementById('profile-img');
    const loginModal = document.getElementById('login-modal');
    const googleLoginBtn = document.getElementById('google-login-btn');
    const authRequiredModal = document.getElementById('auth-required-modal');
    const profileModal = document.getElementById('profile-modal');
    const cartBadge = document.getElementById('cart-badge');
    const mainActionBtn = document.getElementById('main-action-btn');
    const calculationResult = document.getElementById('calculation-result');
    const calculatorForm = document.getElementById('calculator-form');

    async function loadPricingSettings() {
        try {
            const docRef = doc(db, "settings", "pricing");
            const docSnap = await getDoc(docRef);
            pricingSettings = (docSnap.exists() && docSnap.data().categoryRates) ? docSnap.data() : DEFAULT_SETTINGS;
        } catch (error) { pricingSettings = DEFAULT_SETTINGS; }
        populateCategoryDropdown();
    }

    function populateCategoryDropdown() {
        const categorySelect = document.getElementById('product-category');
        if (!categorySelect) return;
        categorySelect.innerHTML = '<option value="" disabled selected>Kategori se√ßin</option>';
        const names = { furniture: "Mobilya & Ev E≈üyasƒ±", clothing: "Giyim & Ayakkabƒ±", cosmetics: "Kozmetik", stationery: "Kƒ±rtasiye & Kitap" };
        for (const key in pricingSettings.categoryRates) {
            const opt = document.createElement('option');
            opt.value = key; opt.textContent = names[key] || key; categorySelect.appendChild(opt);
        }
    }

    onAuthStateChanged(auth, user => {
        if (user) {
            loginBtn.classList.add('hidden'); profileContainer.classList.remove('hidden');
            profileImg.src = user.photoURL; checkUserProfile(user); listenToCart(user.uid);
        } else {
            loginBtn.classList.remove('hidden'); profileContainer.classList.add('hidden');
            if (cartUnsubscribe) cartUnsubscribe(); cartBadge.classList.add('hidden');
        }
    });

    googleLoginBtn.onclick = () => signInWithPopup(auth, new GoogleAuthProvider()).then(() => loginModal.classList.add('hidden'));
    loginBtn.onclick = () => loginModal.classList.remove('hidden');
    document.getElementById('close-login-modal').onclick = () => loginModal.classList.add('hidden');
    profileContainer.onclick = () => confirm('√áƒ±kƒ±≈ü?') && signOut(auth);

    async function checkUserProfile(user) {
        const snap = await getDoc(doc(db, "users", user.uid));
        if (!snap.exists() || !snap.data().isProfileComplete) {
            profileModal.classList.remove('hidden');
            document.getElementById('full-name-input').value = user.displayName || '';
        }
    }

    document.getElementById('profile-form').onsubmit = async (e) => {
        e.preventDefault();
        const user = auth.currentUser;
        await setDoc(doc(db, "users", user.uid), {
            fullName: document.getElementById('full-name-input').value,
            phone: document.getElementById('phone-input').value,
            address: document.getElementById('address-input').value,
            isProfileComplete: true
        }, { merge: true });
        profileModal.classList.add('hidden'); showToast('G√ºncellendi!');
    };

    document.getElementById('calculate-btn').onclick = () => {
        const sec = document.getElementById('calculator-section');
        sec.classList.remove('hidden'); sec.scrollIntoView({ behavior: 'smooth' });
    };

    function resetCalculatorState() {
        mainActionBtn.innerHTML = `<i class="ri-calculator-line"></i><span>Maliyeti Hesapla</span>`;
        calculationResult.classList.add('hidden');
    }
    calculatorForm.querySelectorAll('input, select').forEach(i => i.oninput = resetCalculatorState);

    calculatorForm.onsubmit = async (e) => {
        e.preventDefault();
        if (mainActionBtn.textContent.trim() === 'Maliyeti Hesapla') {
            // üß© √áeviri olsa bile sadece sayƒ±larƒ± okuyan yeni mantƒ±k
            const rawValue = document.getElementById('product-price').value;
            const price = parseFloat(rawValue.toString().replace(/[^0-9.,]/g, '').replace(',', '.'));
            const cat = document.getElementById('product-category').value;
            const method = document.getElementById('order-method').value;

            if (isNaN(price) || price <= 0 || !cat) return showToast('Eksik bilgi!', 'error');

            const fee = price * (pricingSettings.categoryRates[cat] || 0);
            const total = (method === 'self') ? fee : price + fee;

            document.getElementById('result-price-label').textContent = method === 'self' ? '√úr√ºn Fiyatƒ± (Size Ait):' : '√úr√ºn Fiyatƒ±:';
            document.getElementById('result-price').textContent = `${price.toFixed(2)} ‚Ç∫`;
            document.getElementById('result-category-fee').textContent = `${fee.toFixed(2)} ‚Ç∫`;
            document.getElementById('result-total').textContent = `${total.toFixed(2)} ‚Ç∫`;
            
            calculationResult.classList.remove('hidden');
            mainActionBtn.innerHTML = `<i class="ri-shopping-cart-add-line"></i><span>Sepete Ekle</span>`;
        } else {
            const user = auth.currentUser;
            if (!user) return document.getElementById('auth-required-modal').classList.remove('hidden');
            
            const rawValue = document.getElementById('product-price').value;
            const price = parseFloat(rawValue.toString().replace(/[^0-9.,]/g, '').replace(',', '.'));
            
            await addDoc(collection(db, 'users', user.uid, 'cart'), {
                productLink: document.getElementById('product-link').value,
                productPrice: price,
                category: document.getElementById('product-category').value,
                orderMethod: document.getElementById('order-method').value,
                quantity: 1, addedAt: new Date()
            });
            window.location.href = 'https://getirkibris.com/sepet.html';
        }
    };

    function listenToCart(uid) {
        cartUnsubscribe = onSnapshot(collection(db, 'users', uid, 'cart'), s => {
            cartBadge.textContent = s.size; cartBadge.classList.toggle('hidden', s.size === 0);
        });
    }

    function showToast(m, t = 'success') {
        const el = document.getElementById('toast');
        document.getElementById('toast-message').textContent = m;
        el.className = `fixed bottom-24 right-6 text-white px-5 py-3 rounded-lg shadow-xl z-[110] transition-all duration-300 ${t==='error'?'bg-red-500':'bg-gray-800'}`;
        el.classList.remove('opacity-0', 'translate-y-4');
        setTimeout(() => el.classList.add('opacity-0', 'translate-y-4'), 3000);
    }

    loadPricingSettings();
    document.getElementById('close-auth-modal').onclick = () => document.getElementById('auth-required-modal').classList.add('hidden');
    document.getElementById('auth-modal-login-btn').onclick = () => { document.getElementById('auth-required-modal').classList.add('hidden'); loginModal.classList.remove('hidden'); };
</script>
</body>
</html>
