async function loadOrders(page = 1, direction = 'none') {
            ordersTableBody.innerHTML = '<tr><td colspan="6" class="text-center py-4 text-gray-500">Siparişler yükleniyor...</td></tr>';
            
            let query = db.collection('orders');
            
            const searchText = orderSearchInput.value.toLowerCase().trim();
            const statusFilter = orderStatusFilter.value;

            query = query.orderBy('orderDate', 'desc'); // Varsayılan sıralama

            if (statusFilter !== 'all') {
                query = query.where('status', '==', statusFilter);
            }
            
            try {
                let snapshot;
                let fetchedOrders = [];

                // Arama metni veya durum filtresi aktifse veya ilk yükleme ise:
                // Tüm uygun siparişleri çekelim (bu kısım çok sipariş varsa yavaşlayabilir)
                const allMatchingQuerySnapshot = await query.get();
                allMatchingQuerySnapshot.forEach(doc => {
                    fetchedOrders.push({ id: doc.id, data: doc.data() });
                });
                
                let displayedOrders = []; // Son kullanıcıya gösterilecek siparişler

                if (searchText !== '') {
                    // İstemci tarafı arama filtrelemesi (daha geniş kapsamlı)
                    fetchedOrders.forEach(item => {
                        const order = item.data;
                        const docId = item.id; // Tam sipariş ID'si
                        const orderIdShort = docId.substring(0, 8).toLowerCase(); // Kısaltılmış ID
                        const customerInfo = (order.fullName || order.userEmail || '').toLowerCase();
                        const productLinkInfo = (order.productLink || '').toLowerCase();
                        
                        // Arama mantığı iyileştirildi
                        // Sipariş ID'sinin hem kısaltılmış hem de tam hali aranıyor (eğer numarasal bir arama ise)
                        // Ürün linki için daha esnek arama
                        if (orderIdShort.includes(searchText) || // Kısaltılmış ID ile arama
                            docId.toLowerCase().includes(searchText) || // Tam ID ile arama
                            customerInfo.includes(searchText) || // Müşteri bilgileri ile arama
                            productLinkInfo.includes(searchText) || // Ürün linki ile arama
                            (order.trackingNumber && order.trackingNumber.toLowerCase().includes(searchText))) // Takip numarası ile arama
                        {
                            displayedOrders.push(item);
                        }
                    });
                } else {
                    displayedOrders = fetchedOrders; // Arama yoksa, çekilen tüm siparişler gösterilir
                }

                // Şimdi sayfalandırmayı displayedOrders dizisi üzerinde yapalım
                const totalOrdersCount = displayedOrders.length;
                const totalPages = Math.ceil(totalOrdersCount / ordersPerPage);

                const startIndex = (page - 1) * ordersPerPage;
                const endIndex = startIndex + ordersPerPage;
                const paginatedOrders = displayedOrders.slice(startIndex, endIndex);

                renderOrdersTable(paginatedOrders); // Tabloyu render eden yeni fonksiyon

                prevOrdersBtn.disabled = page === 1;
                nextOrdersBtn.disabled = page >= totalPages;
                
                if (totalOrdersCount === 0) {
                    ordersPageInfo.textContent = 'Sayfa 0 / 0';
                } else {
                    ordersPageInfo.textContent = `Sayfa ${page} / ${totalPages}`;
                }

                // Sayfalandırma butonlarının Firestore cursorlarını güncelle
                if (searchText === '' && statusFilter === 'all' && totalOrdersCount > 0) {
                    // Sadece genel listeleme ve sayfalandırma için cursorları güncelle
                    // Bu kısım Firestore cursor'ını tam olarak simule etmez, çünkü tüm veriyi çekiyoruz.
                    // Gerçek cursor tabanlı pagination için, sadece ilk sayfa çekildiğinde cursor'ları güncelleyip
                    // diğer sayfalara geçerken yeni sorgular atmamız gerekir.
                    // Mevcut implementasyon, tüm veriyi çekip JS'de paginate ettiği için cursorlar aslında çok anlamlı değil.
                    // Basitlik adına, sadece arama/filtreleme yoksa butonları aktif tutalım.
                    lastVisibleOrder = fetchedOrders[fetchedOrders.length -1]; // Son çekilen belge
                    firstVisibleOrder = fetchedOrders[0]; // İlk çekilen belge
                    
                    prevOrdersBtn.disabled = page === 1;
                    nextOrdersBtn.disabled = page >= totalPages;

                } else {
                    // Arama veya filtreleme yapılıyorsa cursor tabanlı pagination çalışmaz
                    lastVisibleOrder = null;
                    firstVisibleOrder = null;
                    prevOrdersBtn.disabled = true;
                    nextOrdersBtn.disabled = true;
                }

            } catch (error) {
                console.error("Siparişler yüklenirken hata oluştu:", error);
                ordersTableBody.innerHTML = '<tr><td colspan="6" class="px-6 py-4 whitespace-nowrap text-sm text-red-500 text-center">Siparişler yüklenirken bir hata oluştu. Lütfen konsolu kontrol edin.</td></tr>';
            }
        }
