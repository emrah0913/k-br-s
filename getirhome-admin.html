<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Getir Home Admin | Getir KÄ±brÄ±s</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script type="module">
    // === Firebase BaÄŸlantÄ±sÄ± ===
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";
    import { getAuth, onAuthStateChanged, signInWithPopup, GoogleAuthProvider } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCHms5Y5x-KOu3Y43FrfRoljmW_4m3H4yY",
      authDomain: "kibris-6b4f7.firebaseapp.com",
      projectId: "kibris-6b4f7",
      storageBucket: "kibris-6b4f7.firebasestorage.app",
      messagingSenderId: "141262926171",
      appId: "1:141262926171:web:07226845e51d4bbc0dea7e",
      measurementId: "G-JL9P6BRZTD"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    // === Admin kontrolÃ¼ ===
    async function checkAdmin(user) {
      if (!user) {
        // GiriÅŸ yapÄ±lmamÄ±ÅŸ â†’ yÃ¶nlendir
        window.location.href = "/getirhome.html";
        return;
      }

      const userRef = doc(db, "users", user.uid);
      const userSnap = await getDoc(userRef);

      if (!userSnap.exists() || userSnap.data().role !== "admin") {
        // Admin deÄŸil â†’ yÃ¶nlendir
        alert("Bu sayfaya sadece adminler eriÅŸebilir.");
        window.location.href = "/getirhome.html";
        return;
      }

      // Admin onaylÄ± kullanÄ±cÄ± giriÅŸi tamam
      document.getElementById("admin-content").classList.remove("hidden");
      document.getElementById("user-email").textContent = user.email;
    }

    // === GiriÅŸ kontrolÃ¼ ===
    onAuthStateChanged(auth, async (user) => {
      if (!user) {
        // Oturum yoksa giriÅŸ ekranÄ± gÃ¶ster
        document.getElementById("login-screen").classList.remove("hidden");
      } else {
        // Admin kontrolÃ¼ yap
        await checkAdmin(user);
      }
    });

    // === Google ile giriÅŸ ===
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("google-login").addEventListener("click", async () => {
        try {
          await signInWithPopup(auth, provider);
        } catch (e) {
          alert("GiriÅŸ yapÄ±lamadÄ±: " + e.message);
        }
      });
    });

  </script>
</head>

<body class="bg-gray-100 min-h-screen flex flex-col items-center justify-center">

  <!-- GiriÅŸ ekranÄ± -->
  <div id="login-screen" class="hidden text-center">
    <h1 class="text-2xl font-bold mb-4 text-blue-700">Admin GiriÅŸi</h1>
    <button id="google-login" class="bg-blue-600 text-white px-5 py-2 rounded-lg hover:bg-blue-700">
      Google ile GiriÅŸ Yap
    </button>
  </div>

  <!-- Admin Ä°Ã§eriÄŸi -->
  <div id="admin-content" class="hidden w-full max-w-5xl mx-auto p-6 bg-white shadow-lg rounded-xl">
    <h1 class="text-2xl font-bold text-blue-700 mb-4">Getir Home Admin Paneli</h1>
    <p class="text-gray-600 mb-6">
      GiriÅŸ yapan: <span id="user-email" class="font-semibold text-gray-800"></span>
    </p>

    <!-- Buradan itibaren sadece admin gÃ¶rebilir -->
    <div class="space-y-4">
      <a href="/admin-banners.html" class="block bg-blue-100 hover:bg-blue-200 px-4 py-2 rounded-lg">
        ğŸ–¼ï¸ Banner YÃ¶netimi
      </a>
      <a href="/admin-categories.html" class="block bg-blue-100 hover:bg-blue-200 px-4 py-2 rounded-lg">
        ğŸ—‚ï¸ Kategori YÃ¶netimi
      </a>
      <a href="/admin-products.html" class="block bg-blue-100 hover:bg-blue-200 px-4 py-2 rounded-lg">
        ğŸ›’ ÃœrÃ¼n YÃ¶netimi
      </a>
    </div>
  </div>

  <!-- Footer -->
  <footer class="mt-10 text-gray-400 text-sm text-center">
    Â© 2025 Getir KÄ±brÄ±s Admin Paneli
  </footer>

</body>
</html>
